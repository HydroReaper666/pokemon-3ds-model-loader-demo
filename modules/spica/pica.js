((e,t)=>{const s=function(e,t){this.commands={buffers:[[],[]],offsets:[0,0],sizes:[0,0],states:["ready","ready"]},this.commands.current=this.commands.buffers[0],this.parse(e,t)};s.prototype.parse=function(e,t){let s;if(t){s=[];let _=0;for(;_<t/4;)s[_]=e.readUint32(),++_}else s=e;let _=[],G=0;for(;G<s.length;){let e=s[G++],t=s[G++],E=t>>0&65535,n=t>>16&15,r=t>>20&2047;if(t>>31!=0){let t=0;for(;t<=r;){let i={register:E++,parameters:[e],mask:n};_.push(i),t<r&&(e=s[G++]),++t}}else{let t=[e],i=0;for(;i<r;)t.push(s[G++]),++i;let R={register:E,parameters:t,mask:n};_.push(R)}0!=(1&G)&&G++}this.decode(_)},s.prototype.decode=function(e){let _=0;for(;_<e.length;){let G=e[_];if(this.commands.current.push(G),s.commands[G.register])s.commands[G.register].call(this,G);else{let e=Object.keys(s).filter(e=>s[e]===G.register)[0];e?s.unprocessed[e]||(s.unprocessed[e]=!0,t.warn("Unprocessed PICA command "+e)):t.warn("Unprocessed PICA command "+G.register)}++_}},s.unprocessed={},s.GPUREG_DUMMY=0,s.GPUREG_FINALIZE=16,s.GPUREG_FACECULLING_CONFIG=64,s.GPUREG_VIEWPORT_WIDTH=65,s.GPUREG_VIEWPORT_INVW=66,s.GPUREG_VIEWPORT_HEIGHT=67,s.GPUREG_VIEWPORT_INVH=68,s.GPUREG_FRAGOP_CLIP=71,s.GPUREG_FRAGOP_CLIP_DATA0=72,s.GPUREG_FRAGOP_CLIP_DATA1=73,s.GPUREG_FRAGOP_CLIP_DATA2=74,s.GPUREG_FRAGOP_CLIP_DATA3=75,s.GPUREG_DEPTHMAP_SCALE=77,s.GPUREG_DEPTHMAP_OFFSET=78,s.GPUREG_SH_OUTMAP_TOTAL=79,s.GPUREG_SH_OUTMAP_O0=80,s.GPUREG_SH_OUTMAP_O1=81,s.GPUREG_SH_OUTMAP_O2=82,s.GPUREG_SH_OUTMAP_O3=83,s.GPUREG_SH_OUTMAP_O4=84,s.GPUREG_SH_OUTMAP_O5=85,s.GPUREG_SH_OUTMAP_O6=86,s.GPUREG_EARLYDEPTH_FUNC=97,s.GPUREG_EARLYDEPTH_TEST1=98,s.GPUREG_EARLYDEPTH_CLEAR=99,s.GPUREG_SH_OUTATTR_MODE=100,s.GPUREG_SCISSORTEST_MODE=101,s.GPUREG_SCISSORTEST_POS=102,s.GPUREG_SCISSORTEST_DIM=103,s.GPUREG_VIEWPORT_XY=104,s.GPUREG_EARLYDEPTH_DATA=106,s.GPUREG_DEPTHMAP_ENABLE=109,s.GPUREG_RENDERBUF_DIM=110,s.GPUREG_SH_OUTATTR_CLOCK=111,s.GPUREG_TEXUNIT_CONFIG=128,s.GPUREG_TEXUNIT0_BORDER_COLOR=129,s.GPUREG_TEXUNIT0_DIM=130,s.GPUREG_TEXUNIT0_PARAM=131,s.GPUREG_TEXUNIT0_LOD=132,s.GPUREG_TEXUNIT0_ADDR1=133,s.GPUREG_TEXUNIT0_ADDR2=134,s.GPUREG_TEXUNIT0_ADDR3=135,s.GPUREG_TEXUNIT0_ADDR4=136,s.GPUREG_TEXUNIT0_ADDR5=137,s.GPUREG_TEXUNIT0_ADDR6=138,s.GPUREG_TEXUNIT0_SHADOW=139,s.GPUREG_TEXUNIT0_TYPE=142,s.GPUREG_LIGHTING_ENABLE0=143,s.GPUREG_TEXUNIT1_BORDER_COLOR=145,s.GPUREG_TEXUNIT1_DIM=146,s.GPUREG_TEXUNIT1_PARAM=147,s.GPUREG_TEXUNIT1_LOD=148,s.GPUREG_TEXUNIT1_ADDR=149,s.GPUREG_TEXUNIT1_TYPE=150,s.GPUREG_TEXUNIT2_BORDER_COLOR=153,s.GPUREG_TEXUNIT2_DIM=154,s.GPUREG_TEXUNIT2_PARAM=155,s.GPUREG_TEXUNIT2_LOD=156,s.GPUREG_TEXUNIT2_ADDR=157,s.GPUREG_TEXUNIT2_TYPE=158,s.GPUREG_TEXUNIT3_PROCTEX0=168,s.GPUREG_TEXUNIT3_PROCTEX1=169,s.GPUREG_TEXUNIT3_PROCTEX2=170,s.GPUREG_TEXUNIT3_PROCTEX3=171,s.GPUREG_TEXUNIT3_PROCTEX4=172,s.GPUREG_TEXUNIT3_PROCTEX5=173,s.GPUREG_PROCTEX_LUT=175,s.GPUREG_PROCTEX_LUT_DATA0=176,s.GPUREG_PROCTEX_LUT_DATA1=177,s.GPUREG_PROCTEX_LUT_DATA2=178,s.GPUREG_PROCTEX_LUT_DATA3=179,s.GPUREG_PROCTEX_LUT_DATA4=180,s.GPUREG_PROCTEX_LUT_DATA5=181,s.GPUREG_PROCTEX_LUT_DATA6=182,s.GPUREG_PROCTEX_LUT_DATA7=183,s.GPUREG_TEXENV0_SOURCE=192,s.GPUREG_TEXENV0_OPERAND=193,s.GPUREG_TEXENV0_COMBINER=194,s.GPUREG_TEXENV0_COLOR=195,s.GPUREG_TEXENV0_SCALE=196,s.GPUREG_TEXENV1_SOURCE=200,s.GPUREG_TEXENV1_OPERAND=201,s.GPUREG_TEXENV1_COMBINER=202,s.GPUREG_TEXENV1_COLOR=203,s.GPUREG_TEXENV1_SCALE=204,s.GPUREG_TEXENV2_SOURCE=208,s.GPUREG_TEXENV2_OPERAND=209,s.GPUREG_TEXENV2_COMBINER=210,s.GPUREG_TEXENV2_COLOR=211,s.GPUREG_TEXENV2_SCALE=212,s.GPUREG_TEXENV3_SOURCE=216,s.GPUREG_TEXENV3_OPERAND=217,s.GPUREG_TEXENV3_COMBINER=218,s.GPUREG_TEXENV3_COLOR=219,s.GPUREG_TEXENV3_SCALE=220,s.GPUREG_TEXENV_UPDATE_BUFFER=224,s.GPUREG_FOG_COLOR=225,s.GPUREG_GAS_ATTENUATION=228,s.GPUREG_GAS_ACCMAX=229,s.GPUREG_FOG_LUT_INDEX=230,s.GPUREG_FOG_LUT_DATA0=232,s.GPUREG_FOG_LUT_DATA1=233,s.GPUREG_FOG_LUT_DATA2=234,s.GPUREG_FOG_LUT_DATA3=235,s.GPUREG_FOG_LUT_DATA4=236,s.GPUREG_FOG_LUT_DATA5=237,s.GPUREG_FOG_LUT_DATA6=238,s.GPUREG_FOG_LUT_DATA7=239,s.GPUREG_TEXENV4_SOURCE=240,s.GPUREG_TEXENV4_OPERAND=241,s.GPUREG_TEXENV4_COMBINER=242,s.GPUREG_TEXENV4_COLOR=243,s.GPUREG_TEXENV4_SCALE=244,s.GPUREG_TEXENV5_SOURCE=248,s.GPUREG_TEXENV5_OPERAND=249,s.GPUREG_TEXENV5_COMBINER=250,s.GPUREG_TEXENV5_COLOR=251,s.GPUREG_TEXENV5_SCALE=252,s.GPUREG_TEXENV_BUFFER_COLOR=253,s.GPUREG_COLOR_OPERATION=256,s.GPUREG_BLEND_FUNC=257,s.GPUREG_LOGIC_OP=258,s.GPUREG_BLEND_COLOR=259,s.GPUREG_FRAGOP_ALPHA_TEST=260,s.GPUREG_STENCIL_TEST=261,s.GPUREG_STENCIL_OP=262,s.GPUREG_DEPTH_COLOR_MASK=263,s.GPUREG_FRAMEBUFFER_INVALIDATE=272,s.GPUREG_FRAMEBUFFER_FLUSH=273,s.GPUREG_COLORBUFFER_READ=274,s.GPUREG_COLORBUFFER_WRITE=275,s.GPUREG_DEPTHBUFFER_READ=276,s.GPUREG_DEPTHBUFFER_WRITE=277,s.GPUREG_DEPTHBUFFER_FORMAT=278,s.GPUREG_COLORBUFFER_FORMAT=279,s.GPUREG_EARLYDEPTH_TEST2=280,s.GPUREG_FRAMEBUFFER_BLOCK32=283,s.GPUREG_DEPTHBUFFER_LOC=284,s.GPUREG_COLORBUFFER_LOC=285,s.GPUREG_FRAMEBUFFER_DIM=286,s.GPUREG_GAS_LIGHT_XY=288,s.GPUREG_GAS_LIGHT_Z=289,s.GPUREG_GAS_LIGHT_Z_COLOR=290,s.GPUREG_GAS_LUT_INDEX=291,s.GPUREG_GAS_LUT_DATA=292,s.GPUREG_GAS_DELTAZ_DEPTH=294,s.GPUREG_FRAGOP_SHADOW=304,s.GPUREG_LIGHT0_SPECULAR0=320,s.GPUREG_LIGHT0_SPECULAR1=321,s.GPUREG_LIGHT0_DIFFUSE=322,s.GPUREG_LIGHT0_AMBIENT=323,s.GPUREG_LIGHT0_XY=324,s.GPUREG_LIGHT0_Z=325,s.GPUREG_LIGHT0_SPOTDIR_XY=326,s.GPUREG_LIGHT0_SPOTDIR_Z=327,s.GPUREG_LIGHT0_CONFIG=329,s.GPUREG_LIGHT0_ATTENUATION_BIAS=330,s.GPUREG_LIGHT0_ATTENUATION_SCALE=331,s.GPUREG_LIGHT1_SPECULAR0=336,s.GPUREG_LIGHT1_SPECULAR1=337,s.GPUREG_LIGHT1_DIFFUSE=338,s.GPUREG_LIGHT1_AMBIENT=339,s.GPUREG_LIGHT1_XY=340,s.GPUREG_LIGHT1_Z=341,s.GPUREG_LIGHT1_SPOTDIR_XY=342,s.GPUREG_LIGHT1_SPOTDIR_Z=343,s.GPUREG_LIGHT1_CONFIG=345,s.GPUREG_LIGHT1_ATTENUATION_BIAS=346,s.GPUREG_LIGHT1_ATTENUATION_SCALE=347,s.GPUREG_LIGHT2_SPECULAR0=352,s.GPUREG_LIGHT2_SPECULAR1=353,s.GPUREG_LIGHT2_DIFFUSE=354,s.GPUREG_LIGHT2_AMBIENT=355,s.GPUREG_LIGHT2_XY=356,s.GPUREG_LIGHT2_Z=357,s.GPUREG_LIGHT2_SPOTDIR_XY=358,s.GPUREG_LIGHT2_SPOTDIR_Z=359,s.GPUREG_LIGHT2_CONFIG=361,s.GPUREG_LIGHT2_ATTENUATION_BIAS=362,s.GPUREG_LIGHT2_ATTENUATION_SCALE=363,s.GPUREG_LIGHT3_SPECULAR0=368,s.GPUREG_LIGHT3_SPECULAR1=369,s.GPUREG_LIGHT3_DIFFUSE=370,s.GPUREG_LIGHT3_AMBIENT=371,s.GPUREG_LIGHT3_XY=372,s.GPUREG_LIGHT3_Z=373,s.GPUREG_LIGHT3_SPOTDIR_XY=374,s.GPUREG_LIGHT3_SPOTDIR_Z=375,s.GPUREG_LIGHT3_CONFIG=377,s.GPUREG_LIGHT3_ATTENUATION_BIAS=378,s.GPUREG_LIGHT3_ATTENUATION_SCALE=379,s.GPUREG_LIGHT4_SPECULAR0=384,s.GPUREG_LIGHT4_SPECULAR1=385,s.GPUREG_LIGHT4_DIFFUSE=386,s.GPUREG_LIGHT4_AMBIENT=387,s.GPUREG_LIGHT4_XY=388,s.GPUREG_LIGHT4_Z=389,s.GPUREG_LIGHT4_SPOTDIR_XY=390,s.GPUREG_LIGHT4_SPOTDIR_Z=391,s.GPUREG_LIGHT4_CONFIG=393,s.GPUREG_LIGHT4_ATTENUATION_BIAS=394,s.GPUREG_LIGHT4_ATTENUATION_SCALE=395,s.GPUREG_LIGHT5_SPECULAR0=400,s.GPUREG_LIGHT5_SPECULAR1=401,s.GPUREG_LIGHT5_DIFFUSE=402,s.GPUREG_LIGHT5_AMBIENT=403,s.GPUREG_LIGHT5_XY=404,s.GPUREG_LIGHT5_Z=405,s.GPUREG_LIGHT5_SPOTDIR_XY=406,s.GPUREG_LIGHT5_SPOTDIR_Z=407,s.GPUREG_LIGHT5_CONFIG=409,s.GPUREG_LIGHT5_ATTENUATION_BIAS=410,s.GPUREG_LIGHT5_ATTENUATION_SCALE=411,s.GPUREG_LIGHT6_SPECULAR0=416,s.GPUREG_LIGHT6_SPECULAR1=417,s.GPUREG_LIGHT6_DIFFUSE=418,s.GPUREG_LIGHT6_AMBIENT=419,s.GPUREG_LIGHT6_XY=420,s.GPUREG_LIGHT6_Z=421,s.GPUREG_LIGHT6_SPOTDIR_XY=422,s.GPUREG_LIGHT6_SPOTDIR_Z=423,s.GPUREG_LIGHT6_CONFIG=425,s.GPUREG_LIGHT6_ATTENUATION_BIAS=426,s.GPUREG_LIGHT6_ATTENUATION_SCALE=427,s.GPUREG_LIGHT7_SPECULAR0=432,s.GPUREG_LIGHT7_SPECULAR1=433,s.GPUREG_LIGHT7_DIFFUSE=434,s.GPUREG_LIGHT7_AMBIENT=435,s.GPUREG_LIGHT7_XY=436,s.GPUREG_LIGHT7_Z=437,s.GPUREG_LIGHT7_SPOTDIR_XY=438,s.GPUREG_LIGHT7_SPOTDIR_Z=439,s.GPUREG_LIGHT7_CONFIG=441,s.GPUREG_LIGHT7_ATTENUATION_BIAS=442,s.GPUREG_LIGHT7_ATTENUATION_SCALE=443,s.GPUREG_LIGHTING_AMBIENT=448,s.GPUREG_LIGHTING_NUM_LIGHTS=450,s.GPUREG_LIGHTING_CONFIG0=451,s.GPUREG_LIGHTING_CONFIG1=452,s.GPUREG_LIGHTING_LUT_INDEX=453,s.GPUREG_LIGHTING_ENABLE1=454,s.GPUREG_LIGHTING_LUT_DATA0=456,s.GPUREG_LIGHTING_LUT_DATA1=457,s.GPUREG_LIGHTING_LUT_DATA2=458,s.GPUREG_LIGHTING_LUT_DATA3=459,s.GPUREG_LIGHTING_LUT_DATA4=460,s.GPUREG_LIGHTING_LUT_DATA5=461,s.GPUREG_LIGHTING_LUT_DATA6=462,s.GPUREG_LIGHTING_LUT_DATA7=463,s.GPUREG_LIGHTING_LUTINPUT_ABS=464,s.GPUREG_LIGHTING_LUTINPUT_SELECT=465,s.GPUREG_LIGHTING_LUTINPUT_SCALE=466,s.GPUREG_LIGHTING_LIGHT_PERMUTATION=473,s.GPUREG_ATTRIBBUFFERS_LOC=512,s.GPUREG_ATTRIBBUFFERS_FORMAT_LOW=513,s.GPUREG_ATTRIBBUFFERS_FORMAT_HIGH=514,s.GPUREG_ATTRIBBUFFER0_OFFSET=515,s.GPUREG_ATTRIBBUFFER0_CONFIG1=516,s.GPUREG_ATTRIBBUFFER0_CONFIG2=517,s.GPUREG_ATTRIBBUFFER1_OFFSET=518,s.GPUREG_ATTRIBBUFFER1_CONFIG1=519,s.GPUREG_ATTRIBBUFFER1_CONFIG2=520,s.GPUREG_ATTRIBBUFFER2_OFFSET=521,s.GPUREG_ATTRIBBUFFER2_CONFIG1=522,s.GPUREG_ATTRIBBUFFER2_CONFIG2=523,s.GPUREG_ATTRIBBUFFER3_OFFSET=524,s.GPUREG_ATTRIBBUFFER3_CONFIG1=525,s.GPUREG_ATTRIBBUFFER3_CONFIG2=526,s.GPUREG_ATTRIBBUFFER4_OFFSET=527,s.GPUREG_ATTRIBBUFFER4_CONFIG1=528,s.GPUREG_ATTRIBBUFFER4_CONFIG2=529,s.GPUREG_ATTRIBBUFFER5_OFFSET=530,s.GPUREG_ATTRIBBUFFER5_CONFIG1=531,s.GPUREG_ATTRIBBUFFER5_CONFIG2=532,s.GPUREG_ATTRIBBUFFER6_OFFSET=533,s.GPUREG_ATTRIBBUFFER6_CONFIG1=534,s.GPUREG_ATTRIBBUFFER6_CONFIG2=535,s.GPUREG_ATTRIBBUFFER7_OFFSET=536,s.GPUREG_ATTRIBBUFFER7_CONFIG1=537,s.GPUREG_ATTRIBBUFFER7_CONFIG2=538,s.GPUREG_ATTRIBBUFFER8_OFFSET=539,s.GPUREG_ATTRIBBUFFER8_CONFIG1=540,s.GPUREG_ATTRIBBUFFER8_CONFIG2=541,s.GPUREG_ATTRIBBUFFER9_OFFSET=542,s.GPUREG_ATTRIBBUFFER9_CONFIG1=543,s.GPUREG_ATTRIBBUFFER9_CONFIG2=544,s.GPUREG_ATTRIBBUFFER10_OFFSET=545,s.GPUREG_ATTRIBBUFFER10_CONFIG1=546,s.GPUREG_ATTRIBBUFFER10_CONFIG2=547,s.GPUREG_ATTRIBBUFFER11_OFFSET=548,s.GPUREG_ATTRIBBUFFER11_CONFIG1=549,s.GPUREG_ATTRIBBUFFER11_CONFIG2=550,s.GPUREG_INDEXBUFFER_CONFIG=551,s.GPUREG_NUMVERTICES=552,s.GPUREG_GEOSTAGE_CONFIG=553,s.GPUREG_VERTEX_OFFSET=554,s.GPUREG_POST_VERTEX_CACHE_NUM=557,s.GPUREG_DRAWARRAYS=558,s.GPUREG_DRAWELEMENTS=559,s.GPUREG_VTX_FUNC=561,s.GPUREG_FIXEDATTRIB_INDEX=562,s.GPUREG_FIXEDATTRIB_DATA0=563,s.GPUREG_FIXEDATTRIB_DATA1=564,s.GPUREG_FIXEDATTRIB_DATA2=565,s.GPUREG_CMDBUF_SIZE0=568,s.GPUREG_CMDBUF_SIZE1=569,s.GPUREG_CMDBUF_ADDR0=570,s.GPUREG_CMDBUF_ADDR1=571,s.GPUREG_CMDBUF_JUMP0=572,s.GPUREG_CMDBUF_JUMP1=573,s.GPUREG_VSH_NUM_ATTR=578,s.GPUREG_VSH_COM_MODE=580,s.GPUREG_START_DRAW_FUNC0=581,s.GPUREG_VSH_OUTMAP_TOTAL1=586,s.GPUREG_VSH_OUTMAP_TOTAL2=593,s.GPUREG_GSH_MISC0=594,s.GPUREG_GEOSTAGE_CONFIG2=595,s.GPUREG_GSH_MISC1=596,s.GPUREG_PRIMITIVE_CONFIG=606,s.GPUREG_RESTART_PRIMITIVE=607,s.GPUREG_GSH_BOOLUNIFORM=640,s.GPUREG_GSH_INTUNIFORM_I0=641,s.GPUREG_GSH_INTUNIFORM_I1=642,s.GPUREG_GSH_INTUNIFORM_I2=643,s.GPUREG_GSH_INTUNIFORM_I3=644,s.GPUREG_GSH_INPUTBUFFER_CONFIG=649,s.GPUREG_GSH_ENTRYPOINT=650,s.GPUREG_GSH_ATTRIBUTES_PERMUTATION_LOW=651,s.GPUREG_GSH_ATTRIBUTES_PERMUTATION_HIGH=652,s.GPUREG_GSH_OUTMAP_MASK=653,s.GPUREG_GSH_CODETRANSFER_END=655,s.GPUREG_GSH_FLOATUNIFORM_INDEX=656,s.GPUREG_GSH_FLOATUNIFORM_DATA0=657,s.GPUREG_GSH_FLOATUNIFORM_DATA1=658,s.GPUREG_GSH_FLOATUNIFORM_DATA2=659,s.GPUREG_GSH_FLOATUNIFORM_DATA3=660,s.GPUREG_GSH_FLOATUNIFORM_DATA4=661,s.GPUREG_GSH_FLOATUNIFORM_DATA5=662,s.GPUREG_GSH_FLOATUNIFORM_DATA6=663,s.GPUREG_GSH_FLOATUNIFORM_DATA7=664,s.GPUREG_GSH_CODETRANSFER_INDEX=667,s.GPUREG_GSH_CODETRANSFER_DATA0=668,s.GPUREG_GSH_CODETRANSFER_DATA1=669,s.GPUREG_GSH_CODETRANSFER_DATA2=670,s.GPUREG_GSH_CODETRANSFER_DATA3=671,s.GPUREG_GSH_CODETRANSFER_DATA4=672,s.GPUREG_GSH_CODETRANSFER_DATA5=673,s.GPUREG_GSH_CODETRANSFER_DATA6=674,s.GPUREG_GSH_CODETRANSFER_DATA7=675,s.GPUREG_GSH_OPDESCS_INDEX=677,s.GPUREG_GSH_OPDESCS_DATA0=678,s.GPUREG_GSH_OPDESCS_DATA1=679,s.GPUREG_GSH_OPDESCS_DATA2=680,s.GPUREG_GSH_OPDESCS_DATA3=681,s.GPUREG_GSH_OPDESCS_DATA4=682,s.GPUREG_GSH_OPDESCS_DATA5=683,s.GPUREG_GSH_OPDESCS_DATA6=684,s.GPUREG_GSH_OPDESCS_DATA7=685,s.GPUREG_VSH_BOOLUNIFORM=688,s.GPUREG_VSH_INTUNIFORM_I0=689,s.GPUREG_VSH_INTUNIFORM_I1=690,s.GPUREG_VSH_INTUNIFORM_I2=691,s.GPUREG_VSH_INTUNIFORM_I3=692,s.GPUREG_VSH_INPUTBUFFER_CONFIG=697,s.GPUREG_VSH_ENTRYPOINT=698,s.GPUREG_VSH_ATTRIBUTES_PERMUTATION_LOW=699,s.GPUREG_VSH_ATTRIBUTES_PERMUTATION_HIGH=700,s.GPUREG_VSH_OUTMAP_MASK=701,s.GPUREG_VSH_CODETRANSFER_END=703,s.GPUREG_VSH_FLOATUNIFORM_INDEX=704,s.GPUREG_VSH_FLOATUNIFORM_DATA0=705,s.GPUREG_VSH_FLOATUNIFORM_DATA1=706,s.GPUREG_VSH_FLOATUNIFORM_DATA2=707,s.GPUREG_VSH_FLOATUNIFORM_DATA3=708,s.GPUREG_VSH_FLOATUNIFORM_DATA4=709,s.GPUREG_VSH_FLOATUNIFORM_DATA5=710,s.GPUREG_VSH_FLOATUNIFORM_DATA6=711,s.GPUREG_VSH_FLOATUNIFORM_DATA7=712,s.GPUREG_VSH_CODETRANSFER_INDEX=715,s.GPUREG_VSH_CODETRANSFER_DATA0=716,s.GPUREG_VSH_CODETRANSFER_DATA1=717,s.GPUREG_VSH_CODETRANSFER_DATA2=718,s.GPUREG_VSH_CODETRANSFER_DATA3=719,s.GPUREG_VSH_CODETRANSFER_DATA4=720,s.GPUREG_VSH_CODETRANSFER_DATA5=721,s.GPUREG_VSH_CODETRANSFER_DATA6=722,s.GPUREG_VSH_CODETRANSFER_DATA7=723,s.GPUREG_VSH_OPDESCS_INDEX=725,s.GPUREG_VSH_OPDESCS_DATA0=726,s.GPUREG_VSH_OPDESCS_DATA1=727,s.GPUREG_VSH_OPDESCS_DATA2=728,s.GPUREG_VSH_OPDESCS_DATA3=729,s.GPUREG_VSH_OPDESCS_DATA4=730,s.GPUREG_VSH_OPDESCS_DATA5=731,s.GPUREG_VSH_OPDESCS_DATA6=732,s.GPUREG_VSH_OPDESCS_DATA7=733;const _=function(e){e.viewport||(e.viewport={})},G=function(e){e.clipping||(e.clipping={enabled:!1,data:[0,0,0,0]})},E=function(e){e.depth||(e.depth={})},n=function(e){e.depth.early={}},r=function(e){e.shader||(e.shader={})},i=function(e){e.shader.outputMap||(e.shader.outputMap=[])},R=function(e,t,_){e.shader.outputMap[t]={};let G=0;for(;G<4;){let E=_>>8*G&31,n={};switch(e.shader.outputMap[t][{0:"x",1:"y",2:"z",3:"w"}[G]]=n,E){case 0:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.POSITION),n.offset="x";break;case 1:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.POSITION),n.offset="y";break;case 2:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.POSITION),n.offset="z";break;case 3:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.POSITION),n.offset="w";break;case 4:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.QUAT_NORMAL),n.offset="x";break;case 5:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.QUAT_NORMAL),n.offset="y";break;case 6:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.QUAT_NORMAL),n.offset="z";break;case 7:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.QUAT_NORMAL),n.offset="w";break;case 8:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.COLOR),n.offset="r";break;case 9:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.COLOR),n.offset="g";break;case 10:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.COLOR),n.offset="b";break;case 11:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.COLOR),n.offset="a";break;case 12:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.TEXTURE_COORDINATE_0),n.offset="u";break;case 13:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.TEXTURE_COORDINATE_0),n.offset="v";break;case 14:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.TEXTURE_COORDINATE_1),n.offset="u";break;case 15:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.TEXTURE_COORDINATE_1),n.offset="v";break;case 16:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.TEXTURE_COORDINATE_0),n.offset="w";break;case 18:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.VIEW),n.offset="x";break;case 19:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.VIEW),n.offset="y";break;case 20:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.VIEW),n.offset="z";break;case 22:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.TEXTURE_COORDINATE_2),n.offset="u";break;case 23:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.TEXTURE_COORDINATE_2),n.offset="v";break;default:n.register=new s.ShaderOutputRegister(s.ShaderOutputRegister.GENERIC)}++G}},a=function(e){e.shader.vertex||(e.shader.vertex={})},T=function(e){e.shader.vertex.outputMap||(e.shader.vertex.outputMap=[])},o=function(e){e.shader.vertex.attributes||(e.shader.vertex.attributes={})},U=function(e){e.shader.vertex.attributes.permutations||(e.shader.vertex.attributes.permutations=[])},m=function(e){e.shader.vertex.ints||(e.shader.vertex.ints=[])},A=function(e){if(!e.shader.vertex.floats){e.shader.vertex.floats=[];let _=0,G=!1;Object.defineProperty(e.shader.vertex.floats,"index",{get:function(){return _},set:function(e){_=e%256<<2,G=e>>31!=0}}),Object.defineProperty(e.shader.vertex.floats,"is32Bit",{get:function(){return G}}),Object.defineProperty(e.shader.vertex.floats,"setValues",{get:function(){return function(e){let E=()=>{let e=_>>2&95,t=this[e];return t||(t=G?new s.Float32Vector:new s.Float24Vector,this[e]=t),t};e.forEach(e=>{let G=E();G.words[_%4]=e,++_,t.is(G,s.Float24Vector)&&_%4==3&&++_})}.bind(e.shader.vertex.floats)}})}},c=function(e){e.shader.vertex.codes||(e.shader.vertex.codes={})},P=function(e){e.shader.vertex.opdescs||(e.shader.vertex.opdescs={})},h=function(e){e.shader.geometry||(e.shader.geometry={})},O=function(e){e.shader.geometry.outputMap||(e.shader.geometry.outputMap=[])},d=function(e){e.shader.geometry.attributes||(e.shader.geometry.attributes={})},I=function(e){e.shader.geometry.attributes.permutations||(e.shader.geometry.attributes.permutations=[])},F=function(e){e.shader.geometry.ints||(e.shader.geometry.ints=[])},S=function(e){if(!e.shader.geometry.floats){e.shader.geometry.floats=[];let _=0,G=!1;Object.defineProperty(e.shader.geometry.floats,"index",{get:function(){return _},set:function(e){_=e%256<<2,G=e>>31!=0}}),Object.defineProperty(e.shader.geometry.floats,"is32Bit",{get:function(){return G}}),Object.defineProperty(e.shader.geometry.floats,"setValues",{get:function(){return function(e){let E=()=>{let e=_>>2&95,t=this[e];return t||(t=G?new s.Float32Vector:new s.Float24Vector,this[e]=t),t};e.forEach(e=>{let G=E();G.words[_%4]=e,++_,t.is(G,s.Float24Vector)&&_%3==2&&++_})}.bind(e.shader.geometry.floats)}})}},u=function(e){e.shader.geometry.codes||(e.shader.geometry.codes={})},N=function(e){e.shader.geometry.opdescs||(e.shader.geometry.opdescs={})},p=function(e){e.scissor||(e.scissor={})},f=function(e){e.frameBuffer||(e.frameBuffer={})},l=function(e){e.textures||(e.textures={})},D=function(e){e.textures.units||(e.textures.units=[{},{},{},{}])},C=function(e,t,_){let G=e.textures.units[0];G.magnificationFilter=new s.TextureFilter(1&_),G.minificationFilter=new s.TextureFilter(1&_),G.etc1=_>>4&3,G.wrap=[new s.TextureWrap(_>>8&3),new s.TextureWrap(_>>12&3)],G.shadow=0!=(_>>20&1),G.mipmap=0!=(_>>24&1),G.type=new s.TextureType(_>>28&3)},L=function(e){e.lighting||(e.lighting=!0)},H=function(e){e.rendering||(e.rendering={})},g=function(e,t){e.rendering.stages||(e.rendering.stages=[]),e.rendering.stages[t]||(e.rendering.stages[t]=new s.RenderingStage)},B=function(e){e.permissions||(e.permissions={})},M=function(e){e.lightingLUTs||(e.lightingLUTs={})},b=function(e,t,s){e.lightingLUTs.data||(e.lightingLUTs.data=[]),s.forEach(t=>{e.lightingLUTs.data[e.lightingLUTs.index++]=(4095&t)/4095})},V=function(e){e.attributes||(e.attributes={})},w=function(e){e.attributes.buffer||(e.attributes.buffer={})},X=function(e){e.attributes.buffer.mapping||(e.attributes.buffer.mapping=[])},x=function(e){e.attributes.fixeds||(e.attributes.fixeds={index:0})},y=function(e){t.is.nil(e.attributes.fixeds.index)&&(e.attributes.fixeds.index=0),e.attributes.fixeds.data||(e.attributes.fixeds.data=[]),e.attributes.fixeds.data[e.attributes.fixeds.index]||(e.attributes.fixeds.data[e.attributes.fixeds.index]=new s.Float24Vector)};(s.commands={})[s.GPUREG_DUMMY]=function(){},s.commands[s.GPUREG_FINALIZE]=function(){let e=this.commands.buffers.indexOf(this.commands.current);this.commands.states[e]="finalized"},s.commands[s.GPUREG_FACECULLING_CONFIG]=function(e){this.faceCulling=new s.FaceCulling(3&e.parameters[0])},s.commands[s.GPUREG_VIEWPORT_WIDTH]=function(e){_(this),this.viewport.width=2*s.Float24Vector.getFloat(e.parameters[0]%16777216)},s.commands[s.GPUREG_VIEWPORT_INVW]=function(e){_(this),this.viewport.width=2/s.Float32Vector.asFloat32(e.parameters[0])},s.commands[s.GPUREG_VIEWPORT_HEIGHT]=function(e){_(this),this.viewport.height=2*s.Float24Vector.getFloat(e.parameters[0]%16777216)},s.commands[s.GPUREG_VIEWPORT_INVH]=function(e){_(this),this.viewport.height=2/s.Float32Vector.asFloat32(e.parameters[0])},s.commands[s.GPUREG_FRAGOP_CLIP]=function(e){G(this),this.clipping.enabled=0!=(1&e.parameters[0])},s.commands[s.GPUREG_FRAGOP_CLIP_DATA0]=function(e){G(this),this.clipping.data[0]=s.Float32Vector.asFloat32(e.parameters[0])},s.commands[s.GPUREG_FRAGOP_CLIP_DATA1]=function(e){G(this),this.clipping.data[1]=s.Float32Vector.asFloat32(e.parameters[0])},s.commands[s.GPUREG_FRAGOP_CLIP_DATA2]=function(e){G(this),this.clipping.data[2]=s.Float32Vector.asFloat32(e.parameters[0])},s.commands[s.GPUREG_FRAGOP_CLIP_DATA3]=function(e){G(this),this.clipping.data[3]=s.Float32Vector.asFloat32(e.parameters[0])},s.commands[s.GPUREG_DEPTHMAP_SCALE]=function(e){E(this),this.depth.scale=s.Float24Vector.getFloat(e.parameters[0]%16777216)},s.commands[s.GPUREG_DEPTHMAP_OFFSET]=function(e){E(this),this.depth.offset=s.Float24Vector.getFloat(e.parameters[0]%16777216)},s.commands[s.GPUREG_SH_OUTMAP_TOTAL]=function(e){r(this),i(this),this.shader.outputMap.length=7&e.parameters[0]},s.commands[s.GPUREG_SH_OUTMAP_O0]=function(e){r(this),i(this),R(this,0,e.parameters[0])},s.commands[s.GPUREG_SH_OUTMAP_O1]=function(e){r(this),i(this),R(this,1,e.parameters[0])},s.commands[s.GPUREG_SH_OUTMAP_O2]=function(e){r(this),i(this),R(this,2,e.parameters[0])},s.commands[s.GPUREG_SH_OUTMAP_O3]=function(e){r(this),i(this),R(this,3,e.parameters[0])},s.commands[s.GPUREG_SH_OUTMAP_O4]=function(e){r(this),i(this),R(this,4,e.parameters[0])},s.commands[s.GPUREG_SH_OUTMAP_O5]=function(e){r(this),i(this),R(this,5,e.parameters[0])},s.commands[s.GPUREG_SH_OUTMAP_O6]=function(e){r(this),i(this),R(this,6,e.parameters[0])},s.commands[s.GPUREG_EARLYDEPTH_FUNC]=function(e){E(this),n(this),this.depth.early.test={0:">=",1:">",2:"<=",3:"<"}[3&e.parameters[0]]},s.commands[s.GPUREG_EARLYDEPTH_TEST1]=function(e){E(this),n(this),this.depth.early.enabled=0!=(1&e.parameters[0])},s.commands[s.GPUREG_EARLYDEPTH_CLEAR]=function(e){0!=(1&e.parameters[0])&&this.depth&&this.depth.early&&delete this.depth.early},s.commands[s.GPUREG_SH_OUTATTR_MODE]=function(e){r(this),this.shader.outputTextures=0!=(1&e.parameters[0])},s.commands[s.GPUREG_SCISSORTEST_MODE]=function(e){p(this),this.scissor.enabled=0!=(1&e.parameters[0])},s.commands[s.GPUREG_SCISSORTEST_POS]=function(e){p(this),this.scissor.position={x:e.parameters[0]%512,y:(e.parameters[0]>>16)%512}},s.commands[s.GPUREG_SCISSORTEST_DIM]=function(e){p(this),this.scissor.dim={x:e.parameters[0]%512,y:(e.parameters[0]>>16)%512}},s.commands[s.GPUREG_VIEWPORT_XY]=function(e){_(this),this.viewport.position={x:e.parameters[0]%512,y:(e.parameters[0]>>16)%512}},s.commands[s.GPUREG_EARLYDEPTH_DATA]=function(e){E(this),n(this),this.depth.early.clearValue=16777215&e.parameters[0]},s.commands[s.GPUREG_DEPTHMAP_ENABLE]=function(e){E(this),this.depth.enabled=0!=(1&e.parameters[0])},s.commands[s.GPUREG_RENDERBUF_DIM]=function(e){H(this),this.rendering.width=2047&e.parameters[0],this.rendering.height=1+(e.parameters[0]>>12&1023)},s.commands[s.GPUREG_SH_OUTATTR_CLOCK]=function(e){r(this),this.shader.outputAvailables={positionZ:0!=(1&e.parameters[0]),color:0!=(2&e.parameters[0]),texCoord0:0!=(256&e.parameters[0]),texCoord1:0!=(512&e.parameters[0]),texCoord2:0!=(1024&e.parameters[0]),texCoord0W:0!=(65536&e.parameters[0]),quatNormalOrView:0!=(16777216&e.parameters[0])}},s.commands[s.GPUREG_TEXUNIT_CONFIG]=function(e){l(this),D(this);const t=e.parameters[0];!0&t&&(this.textures.units=[{},{},{},{}]),this.textures.units[0].coordinates=0,this.textures.units[0].enabled=0!=(1&t),this.textures.units[1].coordinates=1,this.textures.units[1].enabled=0!=(2&t),this.textures.units[2].coordinates=0!=(t>>13&1)?1:2,this.textures.units[2].enabled=0!=(4&t),this.textures.units[3].coordinates=t>>8&3,this.textures.units[3].enabled=0!=(1024&t)},s.commands[s.GPUREG_TEXUNIT0_BORDER_COLOR]=function(e){l(this),D(this),this.textures.units[0].border=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXUNIT0_DIM]=function(e){l(this),D(this),this.textures.units[0].width=2047&e.parameters[0],this.textures.units[0].height=e.parameters[0]>>16&2047},s.commands[s.GPUREG_TEXUNIT0_PARAM]=function(e){l(this),D(this),C(this,0,e.parameters[0])},s.commands[s.GPUREG_TEXUNIT1_BORDER_COLOR]=function(e){l(this),D(this),this.textures.units[1].border=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXUNIT1_DIM]=function(e){l(this),D(this),this.textures.units[1].width=2047&e.parameters[0],this.textures.units[1].height=e.parameters[0]>>16&2047},s.commands[s.GPUREG_TEXUNIT1_PARAM]=function(e){l(this),D(this),C(this,0,e.parameters[0])},s.commands[s.GPUREG_TEXUNIT2_BORDER_COLOR]=function(e){l(this),D(this),this.textures.units[2].border=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXUNIT2_DIM]=function(e){l(this),D(this),this.textures.units[2].width=2047&e.parameters[0],this.textures.units[2].height=e.parameters[0]>>16&2047},s.commands[s.GPUREG_TEXUNIT2_PARAM]=function(e){l(this),D(this),C(this,0,e.parameters[0])},s.commands[s.GPUREG_LIGHTING_ENABLE0]=function(e){L(this),this.lighting.enabled=0!=(1&e.parameters[0])},s.commands[s.GPUREG_TEXENV0_SOURCE]=function(e){H(this),g(this,0),this.rendering.stages[0].source=new s.RenderingSource(e.parameters[0])},s.commands[s.GPUREG_TEXENV1_SOURCE]=function(e){H(this),g(this,1),this.rendering.stages[1].source=new s.RenderingSource(e.parameters[0])},s.commands[s.GPUREG_TEXENV2_SOURCE]=function(e){H(this),g(this,2),this.rendering.stages[2].source=new s.RenderingSource(e.parameters[0])},s.commands[s.GPUREG_TEXENV3_SOURCE]=function(e){H(this),g(this,3),this.rendering.stages[3].source=new s.RenderingSource(e.parameters[0])},s.commands[s.GPUREG_TEXENV4_SOURCE]=function(e){H(this),g(this,4),this.rendering.stages[4].source=new s.RenderingSource(e.parameters[0])},s.commands[s.GPUREG_TEXENV5_SOURCE]=function(e){H(this),g(this,5),this.rendering.stages[5].source=new s.RenderingSource(e.parameters[0])},s.commands[s.GPUREG_TEXENV0_OPERAND]=function(e){H(this),g(this,0),this.rendering.stages[0].operand=new s.RenderingOperand(e.parameters[0])},s.commands[s.GPUREG_TEXENV1_OPERAND]=function(e){H(this),g(this,1),this.rendering.stages[1].operand=new s.RenderingOperand(e.parameters[0])},s.commands[s.GPUREG_TEXENV2_OPERAND]=function(e){H(this),g(this,2),this.rendering.stages[2].operand=new s.RenderingOperand(e.parameters[0])},s.commands[s.GPUREG_TEXENV3_OPERAND]=function(e){H(this),g(this,3),this.rendering.stages[3].operand=new s.RenderingOperand(e.parameters[0])},s.commands[s.GPUREG_TEXENV4_OPERAND]=function(e){H(this),g(this,4),this.rendering.stages[4].operand=new s.RenderingOperand(e.parameters[0])},s.commands[s.GPUREG_TEXENV5_OPERAND]=function(e){H(this),g(this,5),this.rendering.stages[5].operand=new s.RenderingOperand(e.parameters[0])},s.commands[s.GPUREG_TEXENV0_COMBINER]=function(e){H(this),g(this,0),this.rendering.stages[0].mode=new s.RenderingMode(e.parameters[0])},s.commands[s.GPUREG_TEXENV1_COMBINER]=function(e){H(this),g(this,1),this.rendering.stages[1].mode=new s.RenderingMode(e.parameters[0])},s.commands[s.GPUREG_TEXENV2_COMBINER]=function(e){H(this),g(this,2),this.rendering.stages[2].mode=new s.RenderingMode(e.parameters[0])},s.commands[s.GPUREG_TEXENV3_COMBINER]=function(e){H(this),g(this,3),this.rendering.stages[3].mode=new s.RenderingMode(e.parameters[0])},s.commands[s.GPUREG_TEXENV4_COMBINER]=function(e){H(this),g(this,4),this.rendering.stages[4].mode=new s.RenderingMode(e.parameters[0])},s.commands[s.GPUREG_TEXENV5_COMBINER]=function(e){H(this),g(this,5),this.rendering.stages[5].mode=new s.RenderingMode(e.parameters[0])},s.commands[s.GPUREG_TEXENV0_COLOR]=function(e){H(this),g(this,0),this.rendering.stages[0].color=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXENV1_COLOR]=function(e){H(this),g(this,1),this.rendering.stages[1].color=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXENV2_COLOR]=function(e){H(this),g(this,2),this.rendering.stages[2].color=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXENV3_COLOR]=function(e){H(this),g(this,3),this.rendering.stages[3].color=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXENV4_COLOR]=function(e){H(this),g(this,4),this.rendering.stages[4].color=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXENV5_COLOR]=function(e){H(this),g(this,5),this.rendering.stages[5].color=new s.Color(e.parameters[0])},s.commands[s.GPUREG_TEXENV0_SCALE]=function(e){H(this),g(this,0),this.rendering.stages[0].scale=new s.RenderingScale(e.parameters[0])},s.commands[s.GPUREG_TEXENV1_SCALE]=function(e){H(this),g(this,1),this.rendering.stages[1].scale=new s.RenderingScale(e.parameters[0])},s.commands[s.GPUREG_TEXENV2_SCALE]=function(e){H(this),g(this,2),this.rendering.stages[2].scale=new s.RenderingScale(e.parameters[0])},s.commands[s.GPUREG_TEXENV3_SCALE]=function(e){H(this),g(this,3),this.rendering.stages[3].scale=new s.RenderingScale(e.parameters[0])},s.commands[s.GPUREG_TEXENV4_SCALE]=function(e){H(this),g(this,4),this.rendering.stages[4].scale=new s.RenderingScale(e.parameters[0])},s.commands[s.GPUREG_TEXENV5_SCALE]=function(e){H(this),g(this,5),this.rendering.stages[5].scale=new s.RenderingScale(e.parameters[0])},s.commands[s.GPUREG_TEXENV_UPDATE_BUFFER]=function(e){H(this),this.rendering.fogMode=7&e.parameters[0],this.rendering.densitySource=e.parameters[0]>>3&1?"depth":"plain",g(this,0),this.rendering.stages[0].buffers={color:0!=(e.parameters[0]>>8&1),alpha:0!=(e.parameters[0]>>12&1)},g(this,1),this.rendering.stages[1].buffers={color:0!=(e.parameters[0]>>9&1),alpha:0!=(e.parameters[0]>>13&1)},g(this,2),this.rendering.stages[2].buffers={color:0!=(e.parameters[0]>>10&1),alpha:0!=(e.parameters[0]>>14&1)},g(this,3),this.rendering.stages[3].buffers={color:0!=(e.parameters[0]>>11&1),alpha:0!=(e.parameters[0]>>15&1)},this.rendering.zFlip=0!=(e.parameters[0]>>16&1)},s.commands[s.GPUREG_TEXENV_BUFFER_COLOR]=function(e){H(this),this.rendering.bufferColor=new s.Color(e.parameters[0])},s.commands[s.GPUREG_COLOR_OPERATION]=function(e){H(this),this.rendering.colorOperation=new s.ColorOperation(e.parameters[0])},s.commands[s.GPUREG_BLEND_FUNC]=function(e){H(this),this.rendering.blendFunction=new s.BlendFunction(e.parameters[0])},s.commands[s.GPUREG_LOGIC_OP]=function(e){H(this),this.rendering.logicalOperation=new s.LogicalOperation(15&e.parameters[0])},s.commands[s.GPUREG_BLEND_COLOR]=function(e){H(this),this.rendering.blendColor=new s.Color(e.parameters[0])},s.commands[s.GPUREG_FRAGOP_ALPHA_TEST]=function(e){H(this),this.rendering.alphaTest=new s.AlphaTest(e.parameters[0])},s.commands[s.GPUREG_STENCIL_TEST]=function(e){H(this),this.rendering.stencilTest=new s.StencilTest(e.parameters[0])},s.commands[s.GPUREG_STENCIL_OP]=function(e){H(this),this.rendering.stencilOperation=new s.StencilOperation(e.parameters[0])},s.commands[s.GPUREG_DEPTH_COLOR_MASK]=function(e){E(this),this.depth.colorMask=new s.DepthColorMask(e.parameters[0])},s.commands[s.GPUREG_FRAMEBUFFER_INVALIDATE]=function(e){H(this),this.rendering.dirty=0!=(1&e.parameters[0])},s.commands[s.GPUREG_FRAMEBUFFER_FLUSH]=function(e){H(this),this.rendering.dirty=0==(1&e.parameters[0])},s.commands[s.GPUREG_COLORBUFFER_READ]=function(e){B(this),this.permissions.colorBufferRead=15==(15&e.parameters[0])},s.commands[s.GPUREG_COLORBUFFER_WRITE]=function(e){B(this),this.permissions.colorBufferWrite=15==(15&e.parameters[0])},s.commands[s.GPUREG_DEPTHBUFFER_READ]=function(e){B(this),this.permissions.stencilBufferRead=0!=(1&e.parameters[0]),this.permissions.depthBufferRead=0!=(2&e.parameters[0])},s.commands[s.GPUREG_DEPTHBUFFER_WRITE]=function(e){B(this),this.permissions.stencilBufferWrite=0!=(1&e.parameters[0]),this.permissions.depthBufferWrite=0!=(2&e.parameters[0])},s.commands[s.GPUREG_EARLYDEPTH_TEST2]=s.commands[s.GPUREG_EARLYDEPTH_TEST1],s.commands[s.GPUREG_FRAMEBUFFER_DIM]=function(e){f(this),this.frameBuffer.width=2047&e.parameters[0],this.frameBuffer.height=1+(e.parameters[0]>>12&1023)},s.commands[s.GPUREG_LIGHTING_LUT_INDEX]=function(e){M(this),this.lightingLUTs.index=255&e.parameters[0],this.lightingLUTs.type=new s.LUTType(e.parameters[0]>>8)},s.commands[s.GPUREG_LIGHTING_LUT_DATA0]=function(e){M(this),b(this,0,e.parameters)},s.commands[s.GPUREG_LIGHTING_LUT_DATA1]=s.commands[s.GPUREG_LIGHTING_LUT_DATA0],s.commands[s.GPUREG_LIGHTING_LUT_DATA2]=s.commands[s.GPUREG_LIGHTING_LUT_DATA0],s.commands[s.GPUREG_LIGHTING_LUT_DATA3]=s.commands[s.GPUREG_LIGHTING_LUT_DATA0],s.commands[s.GPUREG_LIGHTING_LUT_DATA4]=s.commands[s.GPUREG_LIGHTING_LUT_DATA0],s.commands[s.GPUREG_LIGHTING_LUT_DATA5]=s.commands[s.GPUREG_LIGHTING_LUT_DATA0],s.commands[s.GPUREG_LIGHTING_LUT_DATA6]=s.commands[s.GPUREG_LIGHTING_LUT_DATA0],s.commands[s.GPUREG_LIGHTING_LUT_DATA7]=s.commands[s.GPUREG_LIGHTING_LUT_DATA0],s.commands[s.GPUREG_LIGHTING_LUTINPUT_ABS]=function(e){M(this),this.lightingLUTs.inputAbsolute=new s.LightingLUTInputAbsolute(e.parameters[0])},s.commands[s.GPUREG_LIGHTING_LUTINPUT_SELECT]=function(e){M(this),this.lightingLUTs.inputSelection=new s.LightingLUTInputSelection(e.parameters[0])},s.commands[s.GPUREG_LIGHTING_LUTINPUT_SCALE]=function(e){M(this),this.lightingLUTs.inputScale=new s.LightingLUTInputScale(e.parameters[0])},s.commands[s.GPUREG_ATTRIBBUFFERS_LOC]=function(e){V(this),this.attributes.location=e.parameters/2>>27},s.commands[s.GPUREG_ATTRIBBUFFERS_FORMAT_LOW]=function(e){V(this),this.attributes.formats||(this.attributes.formats=[]);let t=0;for(;t<8;){let _=e.parameters[0]/Math.pow(2,4*t)%16,G=new s.AttributeFormat(3&_),E=1+(_>>2&3);this.attributes.formats[t]||(this.attributes.formats[t]={}),this.attributes.formats[t].type=G,this.attributes.formats[t].size=E,++t}},s.commands[s.GPUREG_ATTRIBBUFFERS_FORMAT_HIGH]=function(e){V(this),this.attributes.formats||(this.attributes.formats=[]);let t=0;for(;t<4;){w(this);let _=e.parameters[0]/Math.pow(2,4*t)%16,G=new s.AttributeFormat(3&_),E=1+(_>>2&3);this.attributes.formats[t+8]||(this.attributes.formats[t+8]={}),this.attributes.formats[t+8].type=G,this.attributes.formats[t+8].size=E,++t}let _=e.parameters[0]/2>>15&8191;for(t=0;t<12;)0!=(_>>t&1)&&(this.attributes.formats[t].fixed=!0),++t;this.attributes.count=1+(e.parameters[0]/2>>27)},s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET]=function(e){V(this),w(this),this.attributes.buffer.offset=e.parameters[0]%268435456},s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1]=function(e){V(this),w(this),X(this);let t=this.attributes.buffer,s=0;for(;s<8;)t.mapping[s]=Math.floor(e.parameters[0]/Math.pow(2,4*s))%16,++s},s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2]=function(e){V(this),w(this),X(this);let t=this.attributes.buffer,s=0;for(;s<4;)t.mapping[s+8]=Math.floor(e.parameters[0]/Math.pow(2,4*s))%16,++s;t.unitSize=e.parameters[0]/2>>15&255,t.components=e.parameters[0]/2>>27&15},s.commands[s.GPUREG_ATTRIBBUFFER1_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER2_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER3_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER4_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER5_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER6_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER7_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER8_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER9_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER10_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER11_OFFSET]=s.commands[s.GPUREG_ATTRIBBUFFER0_OFFSET],s.commands[s.GPUREG_ATTRIBBUFFER1_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER2_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER3_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER4_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER5_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER6_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER7_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER8_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER9_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER10_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER11_CONFIG1]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG1],s.commands[s.GPUREG_ATTRIBBUFFER1_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER2_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER3_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER4_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER5_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER6_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER7_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER8_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER9_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER10_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_ATTRIBBUFFER11_CONFIG2]=s.commands[s.GPUREG_ATTRIBBUFFER0_CONFIG2],s.commands[s.GPUREG_INDEXBUFFER_CONFIG]=function(e){V(this),this.attributes.indices||(this.attributes.indices={}),this.attributes.indices.offset=134217727&e.parameters[0],this.attributes.indices.is16Bit=e.parameters[0]>>31!=0},s.commands[s.GPUREG_NUMVERTICES]=function(e){V(this),this.attributes.verticesCount=e.parameters[0]},s.commands[s.GPUREG_GEOSTAGE_CONFIG]=function(e){H(this),this.rendering.usingGeometryShader=0!=(2&e.parameters[0]),this.rendering.drawingTriangleElements=0!=(16&e.parameters[0])},s.commands[s.GPUREG_VERTEX_OFFSET]=function(e){this.vertices.offset=e.parameters[0]},s.commands[s.GPUREG_POST_VERTEX_CACHE_NUM]=function(){},s.commands[s.GPUREG_DRAWARRAYS]=function(e){this.draw&&this.draw.array&&e.parameters[0]&&this.draw.array(this,e.parameters[0])},s.commands[s.GPUREG_DRAWELEMENTS]=function(e){this.draw&&this.draw.elements&&e.parameters[0]&&this.draw.elements(this,e.parameters[0])},s.commands[s.GPUREG_VTX_FUNC]=function(){},s.commands[s.GPUREG_FIXEDATTRIB_INDEX]=function(e){x(this),this.attributes.fixeds.index=15&e.parameters[0]},s.commands[s.GPUREG_FIXEDATTRIB_DATA0]=function(e){x(this),y(this),this.attributes.fixeds.data[this.attributes.fixeds.index].words[0]=e.parameters[0]},s.commands[s.GPUREG_FIXEDATTRIB_DATA1]=function(e){x(this),y(this),this.attributes.fixeds.data[this.attributes.fixeds.index].words[1]=e.parameters[0]},s.commands[s.GPUREG_FIXEDATTRIB_DATA2]=function(e){x(this),y(this),this.attributes.fixeds.data[this.attributes.fixeds.index].words[2]=e.parameters[0]},s.commands[s.GPUREG_CMDBUF_SIZE0]=function(e){this.commands.sizes[0]=4194303&e.parameters[0]},s.commands[s.GPUREG_CMDBUF_SIZE1]=function(e){this.commands.sizes[1]=4194303&e.parameters[0]},s.commands[s.GPUREG_CMDBUF_ADDR0]=function(e){this.commands.offsets[0]=1073741823&e.parameters[0]},s.commands[s.GPUREG_CMDBUF_ADDR1]=function(e){this.commands.offsets[1]=1073741823&e.parameters[0]},s.commands[s.GPUREG_CMDBUF_JUMP0]=function(e){0!==e.parameters[0]&&(this.commands.current=this.commands.buffers[0])},s.commands[s.GPUREG_CMDBUF_JUMP1]=function(e){0!==e.parameters[0]&&(this.commands.current=this.commands.buffers[1])},s.commands[s.GPUREG_VSH_NUM_ATTR]=function(e){r(this),a(this),o(this),this.shader.vertex.attributes.count=1+(15&e.parameters[0])},s.commands[s.GPUREG_VSH_COM_MODE]=function(e){r(this),a(this),this.shader.vertex.usingGeometryConfiguration=0!=(1&e.parameters[0])},s.commands[s.GPUREG_START_DRAW_FUNC0]=function(e){H(this),this.rendering.drawing=0==(1&e.parameters[0])},s.commands[s.GPUREG_VSH_OUTMAP_TOTAL1]=function(e){r(this),a(this),T(this),this.shader.vertex.outputMap.count=15&e.parameters[0]},s.commands[s.GPUREG_VSH_OUTMAP_TOTAL2]=s.commands[s.GPUREG_VSH_OUTMAP_TOTAL1],s.commands[s.GPUREG_GSH_MISC0]=function(){},s.commands[s.GPUREG_GEOSTAGE_CONFIG2]=function(e){H(this),this.rendering.drawingElements=0==(1&e.parameters[0]),this.rendering.drawingArrays=0!=(1&e.parameters[0]),this.rendering.drawingTriangleElements=0!=(16&e.parameters[0])},s.commands[s.GPUREG_PRIMITIVE_CONFIG]=function(e){H(this),this.rendering.outputRegisters=1+(15&e.parameters[0]),this.rendering.primitiveMode=new s.PrimitiveMode(e.parameters[0]>>8)},s.commands[s.GPUREG_RESTART_PRIMITIVE]=function(e){1&e.parameters[0]&&(H(this),this.rendering.outputRegisters=1,this.rendering.primitiveMode=new s.PrimitiveMode(0))},s.commands[s.GPUREG_GSH_BOOLUNIFORM]=function(e){r(this),h(this),this.shader.geometry.bools=[];let t=e.parameters[0]%256,s=0;for(;s<16;)this.shader.geometry.bools[s]=0!=(t>>s&1),++s},s.commands[s.GPUREG_GSH_INTUNIFORM_I0]=function(e){r(this),h(this),F(this),this.shader.geometry.ints[0]={x:e.parameters[0]%256,y:255&Math.floor(e.parameters[0]/256),z:255&Math.floor(e.parameters[0]/65536),w:255&Math.floor(e.parameters[0]/16777216)}},s.commands[s.GPUREG_GSH_INTUNIFORM_I1]=function(e){r(this),h(this),F(this),this.shader.geometry.ints[1]={x:e.parameters[0]%256,y:255&Math.floor(e.parameters[0]/256),z:255&Math.floor(e.parameters[0]/65536),w:255&Math.floor(e.parameters[0]/16777216)}},s.commands[s.GPUREG_GSH_INTUNIFORM_I2]=function(e){r(this),h(this),F(this),this.shader.geometry.ints[2]={x:e.parameters[0]%256,y:255&Math.floor(e.parameters[0]/256),z:255&Math.floor(e.parameters[0]/65536),w:255&Math.floor(e.parameters[0]/16777216)}},s.commands[s.GPUREG_GSH_INTUNIFORM_I3]=function(e){r(this),h(this),F(this),this.shader.geometry.ints[3]={x:e.parameters[0]%256,y:255&Math.floor(e.parameters[0]/256),z:255&Math.floor(e.parameters[0]/65536),w:255&Math.floor(e.parameters[0]/16777216)}},s.commands[s.GPUREG_GSH_INPUTBUFFER_CONFIG]=function(e){r(this),h(this),this.shader.geometry.inputs=1+(15&e.parameters[0]),this.shader.geometry.enabled=128==(e.parameters[0]>>24&255)},s.commands[s.GPUREG_GSH_ENTRYPOINT]=function(e){r(this),h(this),this.shader.geometry.entryPoint=65535&e.parameters[0]},s.commands[s.GPUREG_GSH_ATTRIBUTES_PERMUTATION_LOW]=function(e){r(this),h(this),d(this),I(this);let t=0;for(;t<8;)this.shader.geometry.attributes.permutations[t]=Math.floor(e.parameters[0]/Math.pow(2,4*t))%16,++t},s.commands[s.GPUREG_GSH_ATTRIBUTES_PERMUTATION_HIGH]=function(e){r(this),h(this),d(this),I(this);let t=0;for(;t<8;)this.shader.geometry.attributes.permutations[t+8]=Math.floor(e.parameters[0]/Math.pow(2,4*t))%16,++t},s.commands[s.GPUREG_GSH_OUTMAP_MASK]=function(e){r(this),h(this),O(this);let t=0;for(;t<16;)this.shader.geometry.outputMap[t]=0!=(e.parameters[0]>>t&1),++t},s.commands[s.GPUREG_GSH_CODETRANSFER_END]=function(e){e.parameters[0]&&(r(this),h(this),this.shader.geometry.codes.ready=!0)},s.commands[s.GPUREG_GSH_FLOATUNIFORM_INDEX]=function(e){r(this),h(this),S(this),this.shader.geometry.floats.index=e.parameters[0]},s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA0]=function(e){r(this),h(this),S(this),this.shader.geometry.floats.setValues(e.parameters)},s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA1]=s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA2]=s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA3]=s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA4]=s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA5]=s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA6]=s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA7]=s.commands[s.GPUREG_GSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_GSH_CODETRANSFER_INDEX]=function(e){r(this),h(this),u(this),this.shader.geometry.codes.index=8191&e.parameters[0]},s.commands[s.GPUREG_GSH_CODETRANSFER_DATA0]=function(e){r(this),h(this),u(this),this.shader.geometry.codes.data||(this.shader.geometry.codes.data=[]),e.parameters.forEach(e=>{this.shader.geometry.codes.data[this.shader.geometry.codes.index]=e,++this.shader.geometry.codes.index})},s.commands[s.GPUREG_GSH_CODETRANSFER_DATA1]=s.commands[s.GPUREG_GSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_GSH_CODETRANSFER_DATA2]=s.commands[s.GPUREG_GSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_GSH_CODETRANSFER_DATA3]=s.commands[s.GPUREG_GSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_GSH_CODETRANSFER_DATA4]=s.commands[s.GPUREG_GSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_GSH_CODETRANSFER_DATA5]=s.commands[s.GPUREG_GSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_GSH_CODETRANSFER_DATA6]=s.commands[s.GPUREG_GSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_GSH_CODETRANSFER_DATA7]=s.commands[s.GPUREG_GSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_GSH_OPDESCS_INDEX]=function(e){r(this),h(this),N(this),this.shader.geometry.opdescs.index=8191&e.parameters[0]},s.commands[s.GPUREG_GSH_OPDESCS_DATA0]=function(e){r(this),h(this),N(this),this.shader.geometry.opdescs.data||(this.shader.geometry.opdescs.data=[]),e.parameters.forEach(e=>{this.shader.geometry.opdescs.data[this.shader.geometry.opdescs.index]=e,++this.shader.geometry.opdescs.index})},s.commands[s.GPUREG_GSH_OPDESCS_DATA1]=s.commands[s.GPUREG_GSH_OPDESCS_DATA0],s.commands[s.GPUREG_GSH_OPDESCS_DATA2]=s.commands[s.GPUREG_GSH_OPDESCS_DATA0],s.commands[s.GPUREG_GSH_OPDESCS_DATA3]=s.commands[s.GPUREG_GSH_OPDESCS_DATA0],s.commands[s.GPUREG_GSH_OPDESCS_DATA4]=s.commands[s.GPUREG_GSH_OPDESCS_DATA0],s.commands[s.GPUREG_GSH_OPDESCS_DATA5]=s.commands[s.GPUREG_GSH_OPDESCS_DATA0],s.commands[s.GPUREG_GSH_OPDESCS_DATA6]=s.commands[s.GPUREG_GSH_OPDESCS_DATA0],s.commands[s.GPUREG_GSH_OPDESCS_DATA7]=s.commands[s.GPUREG_GSH_OPDESCS_DATA0],s.commands[s.GPUREG_VSH_BOOLUNIFORM]=function(e){r(this),a(this),this.shader.vertex.bools=[];let t=65535&e.parameters[0],s=0;for(;s<16;)this.shader.vertex.bools[s]=0!=(t>>s&1),++s},s.commands[s.GPUREG_VSH_INTUNIFORM_I0]=function(e){r(this),a(this),m(this),this.shader.vertex.ints[0]={x:e.parameters[0]%256,y:255&Math.floor(e.parameters[0]/256),z:255&Math.floor(e.parameters[0]/65536),w:255&Math.floor(e.parameters[0]/16777216)}},s.commands[s.GPUREG_VSH_INTUNIFORM_I1]=function(e){r(this),a(this),m(this),this.shader.vertex.ints[1]={x:e.parameters[0]%256,y:255&Math.floor(e.parameters[0]/256),z:255&Math.floor(e.parameters[0]/65536),w:255&Math.floor(e.parameters[0]/16777216)}},s.commands[s.GPUREG_VSH_INTUNIFORM_I2]=function(e){r(this),a(this),m(this),this.shader.vertex.ints[2]={x:e.parameters[0]%256,y:255&Math.floor(e.parameters[0]/256),z:255&Math.floor(e.parameters[0]/65536),w:255&Math.floor(e.parameters[0]/16777216)}},s.commands[s.GPUREG_VSH_INTUNIFORM_I3]=function(e){r(this),a(this),m(this),this.shader.vertex.ints[3]={x:e.parameters[0]%256,y:255&Math.floor(e.parameters[0]/256),z:255&Math.floor(e.parameters[0]/65536),w:255&Math.floor(e.parameters[0]/16777216)}},s.commands[s.GPUREG_VSH_INPUTBUFFER_CONFIG]=function(e){r(this),a(this),this.shader.vertex.inputs=1+(15&e.parameters[0])},s.commands[s.GPUREG_VSH_ENTRYPOINT]=function(e){r(this),a(this),this.shader.vertex.entryPoint=65535&e.parameters[0]},s.commands[s.GPUREG_VSH_ATTRIBUTES_PERMUTATION_LOW]=function(e){r(this),a(this),o(this),U(this);let t=0;for(;t<8;)this.shader.vertex.attributes.permutations[t]=Math.floor(e.parameters[0]/Math.pow(2,4*t))%16,++t},s.commands[s.GPUREG_VSH_ATTRIBUTES_PERMUTATION_HIGH]=function(e){r(this),a(this),o(this),U(this);let t=0;for(;t<8;)this.shader.vertex.attributes.permutations[t+8]=Math.floor(e.parameters[0]/Math.pow(2,4*t))%16,++t},s.commands[s.GPUREG_VSH_OUTMAP_MASK]=function(e){r(this),a(this),T(this);let t=0;for(;t<16;)this.shader.vertex.outputMap[t]||(this.shader.vertex.outputMap[t]={}),this.shader.vertex.outputMap[t].enabled=0!=(e.parameters[0]>>t&1),++t},s.commands[s.GPUREG_VSH_CODETRANSFER_END]=function(e){e.parameters[0]&&(r(this),a(this),this.shader.vertex.codes.ready=!0)},s.commands[s.GPUREG_VSH_FLOATUNIFORM_INDEX]=function(e){r(this),a(this),A(this),this.shader.vertex.floats.index=e.parameters[0]},s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA0]=function(e){r(this),a(this),A(this),this.shader.vertex.floats.setValues(e.parameters)},s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA1]=s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA2]=s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA3]=s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA4]=s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA5]=s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA6]=s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA7]=s.commands[s.GPUREG_VSH_FLOATUNIFORM_DATA0],s.commands[s.GPUREG_VSH_CODETRANSFER_INDEX]=function(e){r(this),a(this),c(this),this.shader.vertex.codes.index=8191&e.parameters[0]},s.commands[s.GPUREG_VSH_CODETRANSFER_DATA0]=function(e){r(this),a(this),c(this),this.shader.vertex.codes.data||(this.shader.vertex.codes.data=[]),e.parameters.forEach(e=>{this.shader.vertex.codes.data[this.shader.vertex.codes.index]=e,++this.shader.vertex.codes.index})},s.commands[s.GPUREG_VSH_CODETRANSFER_DATA1]=s.commands[s.GPUREG_VSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_VSH_CODETRANSFER_DATA2]=s.commands[s.GPUREG_VSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_VSH_CODETRANSFER_DATA3]=s.commands[s.GPUREG_VSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_VSH_CODETRANSFER_DATA4]=s.commands[s.GPUREG_VSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_VSH_CODETRANSFER_DATA5]=s.commands[s.GPUREG_VSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_VSH_CODETRANSFER_DATA6]=s.commands[s.GPUREG_VSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_VSH_CODETRANSFER_DATA7]=s.commands[s.GPUREG_VSH_CODETRANSFER_DATA0],s.commands[s.GPUREG_VSH_OPDESCS_INDEX]=function(e){r(this),a(this),P(this),this.shader.vertex.opdescs.index=8191&e.parameters[0]},s.commands[s.GPUREG_VSH_OPDESCS_DATA0]=function(e){r(this),a(this),P(this),this.shader.vertex.opdescs.data||(this.shader.vertex.opdescs.data=[]),e.parameters.forEach(e=>{this.shader.vertex.opdescs.data[this.shader.vertex.opdescs.index]=e,++this.shader.vertex.opdescs.index})},s.commands[s.GPUREG_VSH_OPDESCS_DATA1]=s.commands[s.GPUREG_VSH_OPDESCS_DATA0],s.commands[s.GPUREG_VSH_OPDESCS_DATA2]=s.commands[s.GPUREG_VSH_OPDESCS_DATA0],s.commands[s.GPUREG_VSH_OPDESCS_DATA3]=s.commands[s.GPUREG_VSH_OPDESCS_DATA0],s.commands[s.GPUREG_VSH_OPDESCS_DATA4]=s.commands[s.GPUREG_VSH_OPDESCS_DATA0],s.commands[s.GPUREG_VSH_OPDESCS_DATA5]=s.commands[s.GPUREG_VSH_OPDESCS_DATA0],s.commands[s.GPUREG_VSH_OPDESCS_DATA6]=s.commands[s.GPUREG_VSH_OPDESCS_DATA0],s.commands[s.GPUREG_VSH_OPDESCS_DATA7]=s.commands[s.GPUREG_VSH_OPDESCS_DATA0];const v=function(){Object.defineProperty(this,"words",{value:[]})};v.getFloat=function(e){let t;return 0!=(8388607&e)?(t=(65535&e)<<7,t|=64+(e>>16&127)<<23,t|=(e>>23&1)<<31):t=(8388608&e)<<8,s.Float32Vector.asFloat32(t)},Object.defineProperty(v.prototype,"x",{enumerable:!0,get:function(){let e=this.words[2];return t.is.nil(e)&&(e=0),v.getFloat(16777215&e)}}),Object.defineProperty(v.prototype,"y",{enumerable:!0,get:function(){let e=this.words[2];t.is.nil(e)&&(e=0);let s=this.words[1];t.is.nil(s)&&(s=0);let _=e>>24&255|(65535&s)<<8;return v.getFloat(_)}}),Object.defineProperty(v.prototype,"z",{enumerable:!0,get:function(){let e=this.words[1];t.is.nil(e)&&(e=0);let s=this.words[0];return t.is.nil(s)&&(s=0),v.getFloat(e>>16&65535|(255&s)<<16)}}),Object.defineProperty(v.prototype,"w",{enumerable:!0,get:function(){let e=this.words[0];return t.is.nil(e)&&(e=0),v.getFloat(e>>8&16777215)}}),Object.defineProperty(v.prototype,"0",{get:function(){return this.x}}),Object.defineProperty(v.prototype,"1",{get:function(){return this.y}}),Object.defineProperty(v.prototype,"2",{get:function(){return this.z}}),Object.defineProperty(v.prototype,"3",{get:function(){return this.w}});const W=function(){Object.defineProperty(this,"words",{value:[]})};W.asFloat32=function(e){const t=new DataView(new ArrayBuffer(4));return e>=0?t.setUint32(0,e,!0):t.setInt32(0,e,!0),t.getFloat32(0,!0)},Object.defineProperty(W.prototype,"x",{enumerable:!0,get:function(){return W.asFloat32(this.words[3])}}),Object.defineProperty(W.prototype,"y",{enumerable:!0,get:function(){return W.asFloat32(this.words[2])}}),Object.defineProperty(W.prototype,"z",{enumerable:!0,get:function(){return W.asFloat32(this.words[1])}}),Object.defineProperty(W.prototype,"w",{enumerable:!0,get:function(){return W.asFloat32(this.words[0])}}),Object.defineProperty(W.prototype,"0",{get:function(){return this.x}}),Object.defineProperty(W.prototype,"1",{get:function(){return this.y}}),Object.defineProperty(W.prototype,"2",{get:function(){return this.z}}),Object.defineProperty(W.prototype,"3",{get:function(){return this.w}});const k=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};k.ZERO=0,k.ONE=1,k.SOURCE_COLOR=2,k.ONE_MINUS_SOURCE_COLOR=3,k.DESTINATION_COLOR=4,k.ONE_MINUS_DESTINATION_COLOR=5,k.SOURCE_ALPHA=6,k.ONE_MINUS_SOURCE_ALPHA=7,k.DESTINATION_ALPHA=8,k.ONE_MINUS_DESTINATION_ALPHA=9,k.CONSTANT_COLOR=10,k.ONE_MINUS_CONSTANT_COLOR=11,k.CONSTANT_ALPHA=12,k.ONE_MINUS_CONSTANT_ALPHA=13,k.SOURCE_ALPHA_SATURATE=14;const j=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};j.KEEP=0,j.ZERO=1,j.REPLACE=2,j.INCREMENT=3,j.DECREMENT=4,j.INVERT=5,j.INCREMENT_WRAP=6,j.DECREMENT_WRAP=7;const Y=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};Y.CLEAR=0,Y.AND=1,Y.AND_REVERSE=2,Y.COPY=3,Y.SET=4,Y.COPY_INVERTED=5,Y.NOOP=6,Y.INVERT=7,Y.NAND=8,Y.OR=9,Y.NOR=10,Y.XOR=11,Y.EQUIV=12,Y.AND_INVERTED=13,Y.OR_REVERSE=14,Y.OR_INVERTED=15,Y.OR_INVERTED=15;const Z=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};Z.NEVER=0,Z.FRONT_FACE=1,Z.BACK_FACE=2;const z=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};z.DEFAULT=0,z.GAS=1,z.SHADOW=3;const K=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};K.LOGICAL_OPERATION=0,K.BLEND=1;const Q=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};Q.ADD=0,Q.SUBTRACT=1,Q.REVERSE_SUBTRACT=2,Q.MIN=3,Q.MAX=4;const q=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};q.NEVER=0,q.ALWAYS=1,q.EQUAL_TO=2,q.NOT_EQUAL_TO=3,q.LESS_THAN=4,q.LESS_THAN_OR_EQUAL_TO=5,q.GREATER_THAN=6,q.GREATER_THAN_OR_EQUAL_TO=7;const J=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};J.NORMAL_HALF=0,J.VIEW_HALF=1,J.NORMAL_VIEW=2,J.LIGHT_NORMAL=3,J.LIGHT_SPOT=4,J.PHI=5;const $=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};$.ONE=0,$.TWO=1,$.FOUR=2,$.EIGHT=3,$.QUARTER=6,$.HALF=7;const ee=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};ee.TRIANGLES=0,ee.TRIANGLES_STRIP=1,ee.TRIANGLES_FAN=2,ee.GEOMETRY=3;const te=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};te.POSITION=0,te.NORMAL=1,te.TANGENT=2,te.COLOR=3,te.TEXTURE_COORDINATE_0=4,te.TEXTURE_COORDINATE_1=5,te.TEXTURE_COORDINATE_2=6,te.BONE_INDEX=7,te.BONE_WEIGHT=8,te.USER_ATTRIBUTE_0=9,te.USER_ATTRIBUTE_1=10,te.USER_ATTRIBUTE_2=11,te.USER_ATTRIBUTE_3=12,te.USER_ATTRIBUTE_4=13,te.USER_ATTRIBUTE_5=14,te.USER_ATTRIBUTE_6=15,te.USER_ATTRIBUTE_7=16,te.USER_ATTRIBUTE_8=17,te.USER_ATTRIBUTE_9=18,te.USER_ATTRIBUTE_10=19,te.USER_ATTRIBUTE_11=20,te.INTERLEAVE=21;const se=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};se.INT_8=0,se.UINT_8=1,se.INT_16=2,se.FLOAT_32=3,se.normalizationScale=function(e){let t=e;switch(e.code&&(t=e.code),t){case se.INT_8:return 1/127;case se.UINT_8:return 1/255;case se.INT_16:return 1/32767;case se.FLOAT_32:default:return 1}};const _e=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};_e.PRIMARY_COLOR=0,_e.FRAGMENT_PRIMARY_COLOR=1,_e.FRAGMENT_SECONDARY_COLOR=2,_e.TEXTURE_0=3,_e.TEXTURE_1=4,_e.TEXTURE_2=5,_e.TEXTURE_3=6,_e.PREVIOUS_BUFFER=13,_e.CONSTANT=14,_e.PREVIOUS=15;const Ge=function(){};Object.defineProperty(Ge.prototype,"isColorPassThrough",{get:function(){return this.mode.color.code===s.TextureCombinerMode.REPLACE&&this.source.color[0].code===s.TextureCombinerSource.PREVIOUS&&this.operand.color[0].code===s.TextureCombinerColor.COLOR&&this.scale.color.code===s.TextureCombinerScale.ONE}}),Object.defineProperty(Ge.prototype,"isAlphaPassThrough",{get:function(){return this.mode.alpha.code===s.TextureCombinerMode.REPLACE&&this.source.alpha[0].code===s.TextureCombinerSource.PREVIOUS&&this.operand.alpha[0].code===s.TextureCombinerAlpha.ALPHA&&this.scale.alpha.code===s.TextureCombinerScale.ONE}});const Ee=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};Ee.ALPHA=0,Ee.ONE_MINUS_ALPHA=1,Ee.RED=2,Ee.ONE_MINUS_RED=3,Ee.GREEN=4,Ee.ONE_MINUS_GREEN=5,Ee.BLUE=6,Ee.ONE_MINUS_BLUE=7;const ne=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};ne.COLOR=0,ne.ONE_MINUS_COLOR=1,ne.ALPHA=2,ne.ONE_MINUS_ALPHA=3,ne.RED=4,ne.ONE_MINUS_RED=5,ne.GREEN=8,ne.ONE_MINUS_GREEN=9,ne.BLUE=12,ne.ONE_MINUS_BLUE=13;const re=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};re.REPLACE=0,re.MODULATE=1,re.ADD=2,re.ADD_SIGNED=3,re.INTERPOLATE=4,re.SUBTRACT=5,re.DOT_PRODUCT_3_RGB=6,re.DOT_PRODUCT_3_RGBA=7,re.MUL_ADD=8,re.ADD_MUL=9;const ie=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};ie.ONE=0,ie.TWO=1,ie.FOUR=2;const Re=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};Re.POSITION=0,Re.QUAT_NORMAL=1,Re.COLOR=2,Re.TEXTURE_COORDINATE_0=3,Re.TEXTURE_COORDINATE_0_W=4,Re.TEXTURE_COORDINATE_1=5,Re.TEXTURE_COORDINATE_2=6,Re.VIEW=8,Re.GENERIC=9;const ae=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};ae.CLAMP_TO_EDGE=0,ae.CLAMP_TO_BORDER=1,ae.REPEAT=2,ae.MIRROR=3;const Te=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};Te.NEAREST=0,Te.LINEAR=1;const oe=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};oe["2D"]=0,oe.CUBE_MAP=1,oe.SHADOW_2D=2,oe.PROJECTION=3,oe.SHADOW_CUBE=4,oe.DISABLED=5;const Ue=function(e){this.code=e,this.label=Object.keys(arguments.callee).filter(t=>arguments.callee[t]===e)[0]};Ue.DIST_0=0,Ue.DIST_1=1,Ue.FRESNEL=3,Ue.REFLECT_R=4,Ue.REFLECT_G=5,Ue.REFLECT_B=6,Ue.SPEC_0=8,Ue.SPEC_1=9,Ue.SPEC_2=10,Ue.SPEC_3=11,Ue.SPEC_4=12,Ue.SPEC_5=13,Ue.SPEC_6=14,Ue.SPEC_7=15,Ue.DIST_ATT_0=16,Ue.DIST_ATT_1=17,Ue.DIST_ATT_2=18,Ue.DIST_ATT_3=19,Ue.DIST_ATT_4=20,Ue.DIST_ATT_5=21,Ue.DIST_ATT_6=22,Ue.DIST_ATT_7=23,s.Float24Vector=v,s.Float32Vector=W,s.Color=function(e){t.is(e,Number)?(this.r=e%256,this.g=Math.floor(e/256)%256,this.b=Math.floor(e/256/256)%256,this.a=Math.floor(e/256/256/256)%256):(this.r=e.readUint8(),this.g=e.readUint8(),this.b=e.readUint8(),this.a=e.readUint8())},s.ColorOperation=function(e){this.fragmentOperationMode=new s.FragmentOperationMode(e>>0&3),this.blendMode=new s.BlendMode(e>>8&1)},s.BlendFunction=function(e){this.colorEquation=new s.BlendEquation(e>>0&7),this.alphaEquation=new s.BlendEquation(e>>8&7),this.colorSourceFunction=new s.BlendFunctionOperation(e>>16&15),this.colorDestinationFunction=new s.BlendFunctionOperation(e>>20&15),this.alphaSourceFunction=new s.BlendFunctionOperation(e>>24&15),this.alphaDestinationFunction=new s.BlendFunctionOperation(e>>28&15)},s.BlendFunctionOperation=k,s.AlphaTest=function(e){this.enabled=0!=(1&e),this.testFunction=new s.TestFunction(e>>4&7),this.reference=e>>8},s.StencilTest=function(e){this.enabled=0!=(1&e),this.testFunction=new s.TestFunction(e>>4&7),this.bufferMask=e>>8&255,this.reference=e>>16&255,this.mask=e>>24&255},s.StencilOperation=function(e){this.failOperation=new s.StencilOperationAction(e>>0&7),this.zFailOperation=new s.StencilOperationAction(e>>4&7),this.zPassOperation=new s.StencilOperationAction(e>>8&7)},s.StencilOperationAction=j,s.DepthColorMask=function(e){this.enabled=0!=(1&e),this.depthFunction=new s.TestFunction(e>>4&7),this.redWrite=0!=(256&e),this.greenWrite=0!=(512&e),this.blueWrite=0!=(1024&e),this.alphaWrite=0!=(2048&e),this.depthWrite=0!=(4096&e)},s.LogicalOperation=Y,s.FaceCulling=Z,s.FragmentOperationMode=z,s.BlendMode=K,s.BlendEquation=Q,s.TestFunction=q,s.PrimitiveMode=ee,s.AttributeName=te,s.AttributeFormat=se,s.LightingLUTInputAbsolute=function(e){this.dist0=0==(2&e),this.dist1=0==(32&e),this.specular=0==(512&e),this.fresnel=0==(8192&e),this.reflectR=0==(131072&e),this.reflectG=0==(2097152&e),this.reflectB=0==(33554432&e)},s.LightingLUTInputSelection=function(e){this.dist0=new s.LightingLUTInputSelectionChoice(e>>0&7),this.dist1=new s.LightingLUTInputSelectionChoice(e>>4&7),this.specular=new s.LightingLUTInputSelectionChoice(e>>8&7),this.fresnel=new s.LightingLUTInputSelectionChoice(e>>12&7),this.reflectR=new s.LightingLUTInputSelectionChoice(e>>16&7),this.reflectG=new s.LightingLUTInputSelectionChoice(e>>20&7),this.reflectB=new s.LightingLUTInputSelectionChoice(e>>24&7)},s.LightingLUTInputSelectionChoice=J,s.LightingLUTInputScale=function(e){this.dist0=new s.LightingLUTInputScaleMode(e>>0&7),this.dist1=new s.LightingLUTInputScaleMode(e>>4&7),this.specular=new s.LightingLUTInputScaleMode(e>>8&7),this.fresnel=new s.LightingLUTInputScaleMode(e>>12&7),this.reflectR=new s.LightingLUTInputScaleMode(e>>16&7),this.reflectG=new s.LightingLUTInputScaleMode(e>>20&7),this.reflectB=new s.LightingLUTInputScaleMode(e>>24&7)},s.LightingLUTInputScaleMode=$,s.RenderingStage=Ge,s.RenderingSource=function(e){this.color=[new s.TextureCombinerSource(e>>0&15),new s.TextureCombinerSource(e>>4&15),new s.TextureCombinerSource(e>>8&15)],this.alpha=[new s.TextureCombinerSource(e>>16&15),new s.TextureCombinerSource(e>>20&15),new s.TextureCombinerSource(e>>24&15)]},s.RenderingOperand=function(e){this.color=[new s.TextureCombinerColor(e>>0&15),new s.TextureCombinerColor(e>>4&15),new s.TextureCombinerColor(e>>8&15)],this.alpha=[new s.TextureCombinerAlpha(e>>12&7),new s.TextureCombinerAlpha(e>>16&7),new s.TextureCombinerAlpha(e>>20&7)]},s.RenderingScale=function(e){this.color=new s.TextureCombinerScale(e>>0&3),this.alpha=new s.TextureCombinerScale(e>>16&3)},s.RenderingMode=function(e){this.color=new s.TextureCombinerMode(e>>0&15),this.alpha=new s.TextureCombinerMode(e>>16&15)},s.TextureCombinerSource=_e,s.TextureCombinerAlpha=Ee,s.TextureCombinerColor=ne,s.TextureCombinerMode=re,s.TextureCombinerScale=ie,s.ShaderOutputRegister=Re,s.TextureWrap=ae,s.TextureFilter=Te,s.TextureType=oe,s.LUTType=Ue,module.exports=s})(0,this.$);