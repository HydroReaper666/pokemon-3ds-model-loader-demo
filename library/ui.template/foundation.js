$(function(){var e=-1!==window.navigator.userAgent.toLowerCase().indexOf("msie 8"),t=-1!==window.navigator.userAgent.toLowerCase().indexOf("msie 7"),n=function(e,t,n,a){this.template=e,this.options=t,this.caches=n,this.updater=a};n.prototype.fill=function(e){this.parameters=e;var t=null,n=null;try{t=this.caches.texts.hasOwnProperty(this.template)?$.format.parsers["text/plain"](this.caches.texts[this.template],this.parameters,this.options):$.format.parsers["text/plain"](this.template,this.parameters,this.options,function(e){this.caches.texts[this.template]=e}.bind(this))}catch(e){n=e}return this.hasOwnProperty("lastValue")&&this.lastValue===t?this.updater(n,t,!1):(this.lastValue=t,this.updater(n,t,!0))};var a=function(e,t,n){var a=this;n=$.merge.advanced({animation:{"!valueType":"boolean","!defaultValue":!0},animationDuration:{"!valueType":"number","!defaultValue":1e3},animationStyle:{"!valueType":"string","!defaultValue":"resolve"},animationEasing:{"!valueType":"string","!defaultValue":"default"},animations:{"!valueType":"object","!defaultValue":{}},functors:{"!valueType":"object","!defaultValue":{}},tags:{"!valueType":"object","!defaultValue":{}},outlets:{"!valueType":"object","!defaultValue":{}},basePath:{"!valueType":"string"},inclusionResolver:{"!valueType":"function"},minimumAnimationInterval:{"!valueType":"number","!defaultValue":1e3},predefinedXMLNamespaces:{"!valueType":"object","!defaultValue":{}},uiLock:{"!valueType":"boolean","!defaultValue":!0}},n),Object.keys($.template.functors).forEach(e=>{n.functors[e]=$.template.functors[e]}),this.id=$.uuid(),this.lastRenderTime=Date.now(),this.template=e,this.options=n,this.renderTimes=1,this.templateCaches={texts:{},calls:{},templates:{},externals:{}},this.fillers=[],this.locked=0,this.startPlaceholder=$.template.createPlaceholder(),this.endPlaceholder=$.template.createPlaceholder(),this.fragment=document.createDocumentFragment(),this.fragment.xhtmlTemplate=this,this.document=$.parse("xml",e,{predefinedNamespaces:n.predefinedXMLNamespaces}),this.queue=[],this.state="waiting",t.$t=this.renderTimes;var i=null,o=$.async(function(){i=this});this.ready=function(e){return o.then(e)},this.schedule("initialize",!1,function(){var e=[];return $.async.all(a.document,function(i){$.template.templateNode(i,t,n,a.templateCaches).then(function(t,n,i){t&&$($.template.getRenderingNode(a.fragment)).append(t),n&&($.as.possible(n,"array-like")||(n=[n]),n.forEach(function(e){a.fillers.push(e)})),i&&$(i).forEach(function(t){e.push(t)}),this.next()}).pipe(this)}).all(e,function(e){e.pipe(this)}).then(function(){var e=$($.template.getRenderingNode(a.fragment));e.prepend(a.startPlaceholder),e.append(a.endPlaceholder),this.next(),$.delay(i.next)}).rejected(function(e){$.error("Failed to initialize the template"),$.error(e)})})};a.prototype.schedule=function(e,t,n,a){for(var i=this,o=i.queue.length;o>0;){--o;var l=i.queue[o];l.id===e&&l.omittable&&(i.queue.splice(o,1),$.is(l.omittable,Function)&&l.omittable())}if(i.queue.push({id:e,omittable:t,action:n}),"waiting"===i.state&&i.queue.length>0){var r=function(){i.state="working",process.nextTick(function(){i.queue.shift().action().then(function(){i.queue.length>0?r():i.state="waiting",this.next()}).rejected(function(e){$.error(e)})})};r()}},a.prototype.getAllNodes=function(){var e=[],t=!1,n=!1;return $(this.startPlaceholder).parent().children().forEach(function(a){t||a!==this.startPlaceholder||(t=!0),t&&!n&&e.push(a),n||a!=this.endPlaceholder||(n=!0)}.bind(this)),$(e)},a.prototype.fill=function(e){var t=this;return++t.renderTimes,$.async(function(){var n=this;t.schedule("fill",function(){var e=new Error("Omitted");e.omittable=!0,n.reject(e)},function(){e.$t=t.renderTimes;var a=[];return $.async(function(){var e=t.options.minimumAnimationInterval-(Date.now()-t.lastRenderTime);e>0?$.delay(e,this.next):this.next()}).all(t.fillers,function(t){var n=this;t.fill(e).then(function(e){$.is.nil(e)||$(e).forEach(function(e){a.push(e)}),this.next(),n.next()}).rejected(function(e){n.reject(e)})}).all(a,function(e){e.pipe(this)}).then(function(){$.dom.reinit(t.getAllNodes()),t.lastRenderTime=Date.now(),this.next(),n.next()})})})},a.prototype.render=function(e){e&&$.is(e,String)&&(e=$(e)),e&&!$.is(e,Node)&&(e=e[0]),e||(e=this.fragment);var t=this;return $.async(function(){t.schedule("render",!1,function(){var n=t.getAllNodes();return t.renderingTarget=e,$(e).append(n),$.template.trimNodeWhitespaces(e),$.dom.reinit(n),t.lastRenderTime=Date.now(),e===t.fragment?t.uninstallUILock():t.options.uiLock&&t.installUILock(),this.next(),$.async.resolve()}.bind(this))})},a.prototype.lock=function(){if(++this.locked,1===this.locked){var e=this;e.lockingStep&&e.lockingStep.reject(new Error("Invalid state for template to lock")),e.lockingStep=null;var t=$.async(function(){e.lockingStep=this}).rejected(function(e){throw e});this.schedule("lock",!1,function(){return t})}},a.prototype.unlock=function(){if(--this.locked,0===this.locked){var e=this.lockingStep;if(this.lockingStep=null,!e)throw new Error("Failed to unlock template");e.next()}},a.prototype.afterUnlock=function(e){this.schedule("lock",!1,function(){return e(),$.async.resolve()})},a.prototype.installUILock=function(){var e=this;this.uninstallUILock();var t=$(document.body),n=function(){return!!document.body.contains(this.getAllNodes().first())||(this.uninstallUILock(),!1)}.bind(this);t.on(this.id+".ui-lock.mouse:pressed",function(t,a){n()&&e.lock()}),t.on(this.id+".ui-lock.mouse:released",function(t,a){n()&&e.unlock()}),t.on(this.id+".ui-lock.touch:started",function(t,a){n()&&e.lock()}),t.on(this.id+".ui-lock.touch:ended",function(t,a){n()&&e.unlock()}),t.on(this.id+".ui-lock.touch:canceled",function(t,a){n()&&e.unlock()})},a.prototype.uninstallUILock=function(){$(document.body).off(this.id+".ui-lock.*")},$.format.parsers["text/xhtml"]=function(e,t,n){return new a(e,t,n)},$.template=function(e,t,n){return $.format(e,t,$.merge.simple(n,{parser:"text/xhtml"}))},$.template.Filler=n,$.template.namespaceURI="http://mewmew.cn/support/ui/template",$.template.xNamespaceURI="http://mewmew.cn/support/ui/template-x",$.template.eventPrefixes=["mouse","touch","keyboard","gesture","selection","drag"],$.template.createSandbox=function(e,t){return t?$.merge.simple(e,{"^":e},t):$.merge.simple(e,{"^":e})},$.template.createPlaceholder=function(){return document.createTextNode("")},$.template.getAttribute=function(e,t,n,a,i){var o=!0;$.is(t,String)?(o="-"===t.charAt(0))&&(t=t.substring(1)):$.is(t,Array)&&(o="-"===t[1].charAt(0))&&(t[1]=t[1].substring(1));var l=$(e).attribute(t);if(!l)return $.async.resolve(null);var r=null,s=null;if(o)if(-1!==l.indexOf("${"))try{r=i.texts.hasOwnProperty(l)?$.format.parsers["text/plain"](i.texts[l],n,a):$.format.parsers["text/plain"](l,n,a,function(e){i.texts[l]=e})}catch(e){s=e}else r=l;else{"${"===l.slice(0,2)&&"}"===l.slice(-1)&&(l=l.slice(2,-1)),i.calls.hasOwnProperty(l)||(i.calls[l]=$.format.compile(l,a));try{r=$.format.run(l,i.calls[l],n,a)}catch(e){s=e}}return s?$.async.reject(s):$.async.resolve(r)},$.template.getAnimationDisplay=function(e,t){var n=e.attribute([$.template.namespaceURI,"display"]);if(!n){n="none";for(var a=0;a<t.length;){if(t[a].nodeType==Node.ELEMENT_NODE){var i=$(t[a]);switch(i.style("display")){case"none":break;case"inline":n=getAnimationDisplay(e,i.children());break;case"inline-block":"inline"===n&&(n="inline-block"),"block"===getAnimationDisplay(e,i.children())&&(n="block");break;default:n="block"}if("block"===n)return n}else t[a].nodeType==Node.TEXT_NODE&&t[a].nodeValue.trim().length>0&&"none"===n&&(n="inline");++a}}return"inline"===n&&"yes"!==e.attributeUp($.template.namespaceURI,"inline")&&(n="inline-block"),n},$.template.getAnimation=function(n,a,i,o){n=$(n);var l=function(e,t,a){var o=n.attributeUp($.template.namespaceURI,e);return $.is.nil(o)&&(o=i[t]),a?a(o):o};return{duration:l("duration","animationDuration",function(e){return e=parseInt(e),isFinite(e)?e:1e3}),name:o||t||e?"none":l("animation","animation",function(e){return $.is(e,Boolean)?1==e?"fading":"none":e}),style:l("style","animationStyle",function(e){switch(e=e.trim()){case"erase":case"cover":return e;case"resolve":default:return"resolve"}}),easing:l("easing","animationEasing",function(e){return e.trim()}),easingIn:l("easing-in","animationEasingIn",function(e){return $.is.nil(e)?null:e.trim()}),easingOut:l("easing-out","animationEasingOut",function(e){return $.is.nil(e)?null:e.trim()}),display:$.template.getAnimationDisplay(n,a)}},$.template.createAnimationNodes=function(e,t,n,a,i){var o=function(i){var o=(i=$(i)).parent(),l=i.style(),r=i.nexts().last(),s=$.template.getAnimation(e,i,n,a),p=$.dom.getCollapsedMargins(t),c=$("<div>").addFeatures("template-snapshot","template-display-"+s.display).style({"margin-left":"-"+p.left+"px","margin-top":"-"+p.top+"px"}).append(i.snapshots());l&&l.width&&l.height&&c.style({width:l.width,height:l.height});var u=$("<div>").addFeatures("template-content","template-display-"+s.display).append(i),m=$("<div>").addFeatures("template-animation","template-animation-"+s.name,"template-display-"+s.display).property({template:$(e),templateDisplay:s.display,templateAnimation:s.name,templateAnimationDuration:s.duration,templateAnimationStyle:s.style,templateAnimationEasing:s.easing,templateAnimationEasingIn:s.easingIn,templateAnimationEasingOut:s.easingOut,templateSnapshotNode:c,templateContentNode:u}).append(c).append(u);return o.insert(m,r),m};return i?t.map(o).lifted():o(t)},$.template.detachAnimationNodes=function(e){e.properties("templateSnapshotNode").lifted().detach(),e.properties("templateContentNode").lifted().detach(!0);e.first().parentNode;e.detach(!0)},$.template.updateAnimationNodesDisplay=function(e){var t=$.template.getAnimationDisplay(e.property("template"),e.properties("templateContentNode").lifted().children()),n=e.property("templateDisplay");t!==n&&(e.properties("templateSnapshotNode").lifted().removeFeatures("template-display-"+n),e.properties("templateContentNode").lifted().removeFeatures("template-display-"+n),e.removeFeatures("template-display-"+n),e.properties("templateDisplay",t),e.properties("templateSnapshotNode").lifted().addFeatures("template-display-"+t),e.properties("templateContentNode").lifted().addFeatures("template-display-"+t),e.addFeatures("template-display-"+t))},$.template.archiveAnimationNodes=function(e){e.addFeatures("template-archived")},$.template.formatText=function(e,t,a,i,o){return-1!==e.indexOf("${")?$.async.resolve(new n(e,a,i,o)):$.async.resolve(e)},$.template.templateNode=function(e,t,n,a){return $.template.nodes.hasOwnProperty(e.nodeType)?$.template.nodes[e.nodeType](e,t,n,a):$.async.reject(new Error("Invalid node type to template"))},$.template.getRenderingNode=function(e){return e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.xhtmlTemplate&&e.xhtmlTemplate.renderingTarget?e.xhtmlTemplate.renderingTarget:e},$.template.trimNodeWhitespaces=function(e){var t=!1,n=[],a=[];return Array.prototype.forEach.call(e.childNodes,function(e){e.nodeType===Node.TEXT_NODE&&0===e.nodeValue.trim().length?t?a.push(e):n.push(e):(t=!0,a=[])}),n.length>0&&$(n).text(""),a.length>0&&$(a).text(""),e},$.template.nodes={},$.template.nodes[Node.ELEMENT_NODE]=function(e,t,a,i){var o=e.namespaceURI;o||(o=document.body.namespaceURI);if(a.tags.hasOwnProperty(o)&&a.tags[o].hasOwnProperty(e.localName||e.baseName))return a.tags[o][e.localName||e.baseName](e,t,a,i);if($.template.tags.hasOwnProperty(o)&&$.template.tags[o].hasOwnProperty(e.localName||e.baseName))return $.template.tags[o][e.localName||e.baseName](e,t,a,i);var l=null;l=o===document.body.namespaceURI?document.createElement(e.nodeName):document.createElementNS(o,e.nodeName);var r=$(l),s=[];return $.async.all($(e).attribute(),function(p){if(p.namespaceURI===$.template.namespaceURI){var c=p.localName||p.baseName;if("on-"===c.substring(0,3)){var u=c.slice(3).replace(/_/g,":").split("."),m=u[u.length-1];if(-1===m.indexOf(":")){var d=null;$.template.eventPrefixes.forEach(function(e){0===m.indexOf(e+"-")&&(!d||d.length<e.length)&&(d=e)}),d&&(u[u.length-1]=d+":"+m.slice(d.length+1))}var h=t;s.push(new function(){this.fill=function(e){return h=e,$.async.resolve()}}),$(l).on(u.join("."),function(t,n){var o=$.template.createSandbox(h,{event:t,element:this,parameter:n});$.template.getAttribute(e,[$.template.namespaceURI,c],o,a,i).rejected(function(e){throw e})}),this.next()}else this.next()}else $.template.formatText(p.value,t,a,i,function(t,n,a){return t?$.async.reject(t):(a&&r.attribute([p.namespaceURI,p.nodeName],n),o!==document.body.namespaceURI||"input"!==(e.localName||e.baseName)&&"textarea"!==(e.localName||e.baseName)||"value"!==p.localName||(l.value=n),o===document.body.namespaceURI&&"input"===(e.localName||e.baseName)&&("checked"===p.localName?l.checked=!!n:"readonly"===p.localName&&(l.readOnly=!!n)),o===document.body.namespaceURI&&"option"===(e.localName||e.baseName)&&"selected"===p.localName&&(l.selected=!!n),$.async.resolve())}).then(function(e){$.is(e,n)?(s.push(e),e.fill(t).then(function(){this.next(null,e)}).pipe(this)):(r.attribute([p.namespaceURI,p.nodeName],e),this.next())}).pipe(this)}).then(function(){var n=[];$.async.all($(e).children(),function(e){$.template.templateNode(e,t,a,i).then(function(e,t,a){e&&r.append(e),t&&($.is(t,Array)||(t=[t]),t.forEach(function(e){s.push(e)})),a&&$(a).forEach(function(e){n.push(e)}),this.next()}).pipe(this)}).then(function(){this.next($.template.trimNodeWhitespaces(l),s,n)}).pipe(this)})},$.template.nodes[Node.TEXT_NODE]=function(e,t,a,i){var o=$(document.createTextNode("")),l=!0;return $.template.formatText(e.nodeValue,t,a,i,function(t,n,i){if(t)return $.async.reject(t);if(i){var r=$.template.createAnimationNodes(e,o,a,l);l=!1;var s=a.animations[r.property("templateAnimation")];s||(s=$.template.animations[r.property("templateAnimation")]);var p=s(r.property("templateAnimationDuration"),r,function(){return o.text(n),$.template.archiveAnimationNodes(r),$.async.resolve()},a).then(function(){$.template.detachAnimationNodes(r),this.next()}).rejected(function(e){$.template.detachAnimationNodes(r)});return $.async.resolve([p])}return l=!1,$.async.resolve()}).then(function(e){$.is(e,n)?e.fill(t).then(function(t){this.next(o,e,t)}).pipe(this):(o.text(e),this.next(o))})},$.template.nodes[Node.COMMENT_NODE]=function(e,t,n,a){var i=document.createComment("");return i.nodeValue=e.nodeValue,$.async.resolve(i)},$.template.tags={},$.template.tags[document.body.namespaceURI]={},$.template.tags[$.template.namespaceURI]={},$.template.tags[$.template.xNamespaceURI]={},$.template.tags[$.template.namespaceURI].about=function(e,t,n,a){var i=$(document.createTextNode(""));return i.text("Template 2, Copyright 2011 - 2016, Powered by MEWMEW.CN"),$.async.resolve(i)},$.template.functors={},$.template.functors.prevent=function(e,t,n,a){n.event.preventDefault()},$.template.animations={},$.template.animations.none=function(e,t,n,a){return n()},$.template.animations.fading=function(e,t,n,a){return $.warn("Please implement the real fading animation for template"),n()}});